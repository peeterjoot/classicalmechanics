%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%
%
%
%\input{../peeter_prologue_widescreen.tex}
%\input{../peeter_prologue_print.tex}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% based on: ../gabook/multiPendulumSpherical2.tex
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%% The new paper is a definite improvement.  I think all is not lost.  There is a
%% gem in your work, though unpolished and uncut.  But if we trim the excess
%% material and focus on what facets to highlight, the value of your work would
%% increase.  I shall first enumerate my general comments and suggestions.  Then I
%% shall suggest research directions.  I am very much interested in the
%% applications of geometric algebra to the double pendulum.
%%
%% A.  Comments and Suggestions
%%
%% 1.  Delete all material on matrices.  Readers already have difficulty imagining
%% exponentials of bivectors.  How much more if these are elements of matrices.
%% Reserve these for a future work.  Do not lay down all your cards.  In the last
%% paragraph of your Conclusions, you can mention your future plans, just to let
%% the reader know the depth of your work, in order to give the impression that
%% you just do not want to overwhelm him at the moment.  This is a good tactic and
%% it is used by many journal authors.
%%
%% 2.  Since you are using e_1, e_2, and e_3, I suggest you start your theoretical
%% framework with the orthonormality axiom e_je_k + e_ke_j = 2\delta_jk.  Then
%% define the general element of the algebra and the special properties of the
%% exponential function.
%%
%% 3.  The distributivity and associativity axioms you need not write explicitly.
%% Just mention that the elements of geometric algebra satisfy the distributivity
%% and associativity axioms.  Period.
%%
%% 4.  Delete Eq. (15).  If your paper is not about waves, do not mention waves.
%% But if you will later talk about the double pendulum as coupled simple harmonic
%% oscillators, then revise Eq. (15) in the context of oscillators not waves.
%%
%% 6.  If you are using font 10, it is better to use two columns.  Font 12 is fine
%% for one column double space.
%%
%%
%% B.  Research Directions
%%
%% 1.  Limit your discussion to the double spherical pendulum.  Everybody knows how
%% to write the equations of motion using Lagrangian mechanics.  But I think
%% geometric algebra has really something new to offer: it can rotate vectors in
%% 3D using exponential functions.  Exponential functions are more compact and
%% easier to differentiate than cosines and sines.  Expound on this.  Give
%% diagrams, specially for spherical coordinate systems.
%%
%% 3.  Can geometric algebra derive the equations of motion of the two masses in a
%% double pendulum without constructing the Lagrangian?  The masses are connected
%% by massless rods.  If you can do this, then this would be a good argument for
%% the adoption of geometric algebra.  Vector are more geometrically appealing than
%% scalars.
%%
%% 3.  Can geometric algebra allow us to obtain the normal modes of oscillation of
%% the double pendulum without using matrix inversion?  The strength of geometric
%% algebra is in vectors.  So the best way to exploit the powers of geometric
%% algebra is not to go to potentials and kinetic energies which are scalars, but
%% to employ forces, positions, velocities, and accelerations which are vectors.
%% Do not fight an enemy in his field of choice.  Choose the battlefield most
%% advantageous to you and let your enemy come to you.  Then you shall win more
%% battles, i.e. you shall get published more.
%%
%% 4.  If you can do (3), then you can have a paper industry by extending your
%% results to the vibrations of molecules.  Pesonen of Finland have dabbled on this
%% using geometric algebra, but he still went via the route of kinetic and
%% potential energies.
%%
%% If this research program is interesting to you, I would be happy to lend a hand.
%%  If you have other applications of geometric algebra, I would be happy to know
%% them.  I believe that you have exceptional mathematical prowess and creative
%% insights.  It would a sad loss if nobody gets to read your results.
%%
%%
%
\label{chap:multiPendulumSphericalMatrix}
%\revisionInfo{multiPendulumSphericalMatrix.tex}
%
%I quickly realized when doing this that everything I had done with my GA
%multivector approach can be done in exactly the same way with the
%traditional coordinate representation.  It will produce exactly the
%same results, but is just not something that occured to me initially.
% Unless I can figure out something more interesting to do with the
%multivector matrix formalism, then this particular worked example
%does not likely supply anything really new-not-already-done worthy of a
%scientific style paper.
%
%
%This was an attempt to cleanup my previous N spherical pendulum treatment (ie. equations of motion for an idealized chain). Id used matrixes of multivector elements to arrive at an explicit expression for the kinetic energy for this system and then evaluated the Euler-Lagrange equations. I thought initially that this was pretty nifty, but as I was cleaning this up for an attempted arxiv post, I rudely realized that exactly the same result follows by factoring our a column vector of generalized coordinates (an angular velocity vector of sorts) from the scalar energy expressions (factoring a one by one matrix of scalar values into a product of matrixes).
%
%No use of geometric algebra is required. Without the use of geometic algebra with its compact representation for the spherical parameterized points on the unit sphere, I dont think Id have even attempted this generalized problem. However, the idea that makes the problem tractable is completely independent of GA, and renders the paper as written just an obfuscated way to tackle it (since only a handful of people know this algebraic approach).
%
% REWORK: CHANGE THE FOCUS TO WHAT IS NEW.  PUTTING GA ELEMENTS IN MATRIXES.
% formerly not possible with vector elements since there was no product
% possible.
%
\section*{}
%{\small{
\textbf{Abstract.}
%Derivations of the equations of motion for the double planar pendulum, and for the single spherical pendulum are readily found as examples or problems in Lagrangian mechanics texts.  The generalization of this, treating the double or multiple pendulums, with the planar constraint removed is less common.  It is shown here that Geometric Algebra is an effective way to tackle the formulation of the equations of motion for the general unconstrained multiple pendulum problem.  The end result is free of any Geometric Algebra, with the equations of motion expressed as a single non-linear matrix algebra equation.
%Geometric algebra provides a formalism that allows for coordinate and matrix free representations of vectors, linear transformations, and other mathematical structures.  The replacement of matrix techniques with direct geometric algebra methods is a well studied field, but this need not be an exclusive replacement.  While the geometric algebra multivector space does not constitute a field, operations on multivector element matrices can be defined in a consistent fashion.  This use of geometric algebraic objects in matrices provides a hybrid mathematical framework with immediate applications to mathematical physics.
The dynamics of chain like objects can be idealized as a multiple pendulum, treating the system as a set of point masses, joined by rigid massless connecting rods, and frictionless pivots.  The double planar pendulum and single mass spherical pendulum problems are well treated in Lagrangian physics texts, but due to complexity a similar treatment of the spherical N-pendulum problem is not pervasive.  We show that this problem can be tackled in a direct fashion, even in the general case with multiple masses and no planar constraints.  A matrix factorization of the kinetic energy into allows an explicit and compact specification of the Lagrangian.  Once that is obtained the equations of motion for this generalized pendulum system follow directly.
%
%1. Around 250 words.
%2. Begins with 1-2 sentences of Introduction, usually specific information.
%3. The bulk of the Abstract is the data. This is told by a combination of the
%Methods and Results. The summation of the data is given along with the technique
%used to obtain the data. Specific details about procedure and results are omitted
%unless they are very important.
%4. At the end are 1-2 sentences of Discussion, explaining what the data means and
%summarizing the work.
%5. Somewhere in the abstract (either at the very beginning or very end) is usually a
%phrase/sentence talking about the importance of work being done, or how it
%affects the world/science.
%
%QQ:
%: %P.S. I am not a fan of mixing matrices and vectors, because matrices with vector
%: %arguments are not, I believe, properly defined in general.  I prefer to stick
%: %with the exponentials and do away with matrices.  But this is only my
%: %idiosyncracy.
%
%me:
%: This is perhaps needs to be part of what is discussed.  I had tried it
%: in a more general context with a mix of scalar and bivector
%: parameterized "angular velocities".  The results are perfectly well
%: defined and one ends up with a generalized notion of Hermiticity.
%: Parameterizing the Kinetic energy with the bivector rates does not end
%: up being a helpful approach for the spherical pendulum system, since
%: it is an really over specified with too many degrees of freedom.
%: However, the multivector matrix approach developed there appears to be
%: quite an effective and powerful tool.
%
\section{Introduction}
%2.  An article must have a good introduction.  Notes and assumptions must be
%discussed in the body within the sections and not labeled as a separate
%heading.  An introduction should survey what has been done before, pointing out
%the results in Goldstein, for example, which are similar to what you did.  Start
%with results in well-known texts; Hestenes and Doran's book are known among
%geometric algebraists, but not among ordinary scientists, because geometric
%algebra is still rarely taught in undergraduate and graduate physics and
%mathematics.  Always start with what is familiar, then go to what is unfamiliar
%(e.g. geometric algebra), but make sure that the reader still has his bearings.
% Surveying the literature will increase the number of your references.  The more
%references you have, the more chances of getting endorsed or accepted in ArXiv.
%More references means that you have read much and you really know what you are
%saying.
%
%After surveying the familiar and unfamiliar literature, you have to point out
%the "hole" in the literature which you wish to fill.  Tell the reader how your
%work is similar to what other people did and how it differs.  Was there a work
%on N body spherical pendulums before even if not in geometric algebra?  How far
%did Doran and Hestenes dipped their hands in this problem?  If you are only
%repeating what they did, then there is no more use for writing the paper.  Here
%is a sample paragraph:
%
%"Doran and Hestenes only discussed the single pendulum and derived the Lagrange
%equations in matrix form via geometric algebra.  What I wish to do in this
%paper is to extend their formulation to double and N spherical pendulums.  The
%results will be shown to be equivalent to those in Goldstein, except that our
%matrices can take on complex vector arguments, which allows us to write
%equations in a more compact way and provide an immediate geometrical
%interpretation to the solutions..."
%
%This is the most difficult part of the introduction.  It shall display your
%mastery and authority in your subject area.
%
%
Derivation of the equations of motion for a planar motion constrained double pendulum system and a single spherical pendulum system are given as problems or examples in many texts covering Lagrangian mechanics.  Setup of the Lagrangian, particularly an explicit specification of the system kinetic energy, is the difficult aspect of the multiple mass pendulum problem.  Each mass in the system introduces additional interaction coupling terms, complicating the kinetic energy specification.  In this paper, we use matrix algebra to determine explicitly the Lagrangian for the spherical N pendulum system, and to evaluate the Euler-Lagrange equations for the system.

It is well known that the general specification of the kinetic energy for a system of independent point masses takes the form of a symmetric quadratic form \citep{goldstein1951cm} \citep{hestenes1999nfc}.  However, actually calculating that energy explicitly for the general N-pendulum is likely thought too pedantic for even the most punishing instructor to inflict on students as a problem or example.

Given a \(3 \times 1\) coordinate vector of velocity components for each mass relative to the position of the mass it is connected to, we can factor this as a \((3 \times 2)(2 \times 1)\) product of matrices where the \(2 \times 1\) matrix is a vector of angular velocity components in the spherical polar representation.  The remaining matrix factor contains all the trigonometric dependence.  Such a grouping can be used to tidily separate the kinetic energy into an explicit quadratic form, sandwiching a symmetric matrix between two vectors of generalized velocity coordinates.

This paper is primarily a brute force and direct attack on the problem.  It contains no new science, only a systematic treatment of a problem that is omitted from mechanics texts, yet conceptually simple enough to deserve treatment.

The end result of this paper is a complete and explicit specification of the Lagrangian and evaluation of the Euler-Lagrange equations for the chain-like N spherical pendulum system.  While this end result is essentially nothing more than a non-linear set of coupled differential equations, it is believed that the approach used to obtain it has some elegance.  Grouping all the rotational terms of the kinetic into a symmetric kernel appears to be a tidy way to tackle multiple discrete mass problems.  At the very least, the calculation performed can show that a problem perhaps thought to be too messy for a homework exercise yields nicely to an organized and systematic attack.
%
% TODO:
%The last part of the introduction is a paragraph enumerating the sections of the
%paper, pointing out important results.  In movies, this is a preview or trailer.
% If the reader thinks that he is interested to read the rest of the paper, he
%will read it. If not, the reader will thank you for telling him what lies
%ahead, saving him his precious time.
%
% WHERE:
%The standard orthonormal basis vectors will be denoted \(\Be_1, \Be_2, \Be_3\) with \(\Be_3\) upwards opposing a constant gravitational force of magnitude \(g\).
%
\section{Diving right in}
%
We make the simplifying assumptions of point masses, rigid massless connecting rods, and frictionless pivots.
%
\subsection{Single spherical pendulum}
%
Using polar angle \(\theta\) and azimuthal angle \(\phi\), and writing \(S_\theta = \sin\theta\), \(C_\phi = \cos\phi\) and so forth, we have for the coordinate vector on the unit sphere
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:250}
\begin{aligned}
\rcap =
\begin{bmatrix}
C_\phi S_\theta \\
S_\phi S_\theta \\
       C_\theta
\end{bmatrix}.
\end{aligned}
\end{equation}
%
The Lagrangian for the pendulum is then
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:251}
\begin{aligned}
\LL = \inv{2} m l \dot{\rcap}^T \dot{\rcap} - m g l C_\theta.
\end{aligned}
\end{equation}
%
This is somewhat unsatisfying since the unit vector derivatives have not been evaluated.  Doing so we get
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:260}
\begin{aligned}
\dot{\rcap} =
\begin{bmatrix}
C_\phi C_\theta \dot{\theta} - S_\phi S_\theta \dot{\phi} \\
S_\phi C_\theta \dot{\theta} + C_\phi S_\theta \dot{\phi} \\
      -S_\theta \dot{\theta}
\end{bmatrix}.
\end{aligned}
\end{equation}
%
This however, is an ugly beastie to take the norm of as is.  It is straightforward to show that this norm is just
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:261}
\begin{aligned}
\dot{\rcap}^\T \dot{\rcap} = \dot{\theta}^2 + S_\theta^2 \dot{\phi}^2,
\end{aligned}
\end{equation}
%
however, the brute force multiplication that leads to this result is not easily generalized to the multiple pendulum problem.  Instead of actually expanding this now, lets defer that until later and instead write for a coordinate vector of angular velocity components
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:262}
\begin{aligned}
\Omega =
\begin{bmatrix}
\dot{\theta} \\
\dot{\phi}
\end{bmatrix}.
\end{aligned}
\end{equation}
%
Now the unit polar derivative \eqnref{eqn:multiPendulumSphericalMatrix:260} can be factored as
%
\begin{subequations}
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:260b}
\begin{aligned}
\dot{\rcap} &= A^\T \Omega \\
A
&=
\begin{bmatrix}
C_\phi C_\theta & S_\phi C_\theta & -S_\theta \\
- S_\phi S_\theta &   C_\phi S_\theta & 0
\end{bmatrix}
.
\end{aligned}
\end{equation}
\end{subequations}
%
Our Lagrangian now takes the explicit form
%
\begin{subequations}
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:251b}
\begin{aligned}
\LL &= \inv{2} m l \Omega^\T A A^\T \Omega - m g l C_\theta \\
A A^\T &=
\begin{bmatrix}
1 & 0 \\
0 & S_\theta^2
\end{bmatrix}.
\end{aligned}
\end{equation}
\end{subequations}
%
\subsection{Spherical double pendulum}
%
%A multiple (two) particle spherical pendulum is depicted in \cref{fig:pendulumDouble}
%
%\begin{figure}[htp]
%\centering
%\includegraphics[totalheight=0.4\textheight]{pendulumDouble}
%\caption{Double spherical pendulum.}\label{fig:pendulumDouble}
%\end{figure}
%
%
Before generalizing to N links, consider the double pendulum.  Let the position of each of the k-th mass (with \( k = 1,2 \)) be
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:700}
\Bu_k = \Bu_{k-1} + l_k \rcap_k = \sum_{j = 1}^k l_k \rcap_k
\end{equation}
%
The unit vectors from the origin to the first mass, or from the first mass to the second have derivatives
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:720}
\dot{\rcap}_k = {A_k}^\T \dot{\BTheta}_k,
\end{equation}
%
where
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:600}
\begin{aligned}
A_k
&=
\begin{bmatrix}
C_{\phi_k} C_{\theta_k} & S_{\phi_k} C_{\theta_k} & -S_{\theta_k} \\
- S_{\phi_k} S_{\theta_k} &   C_{\phi_k} S_{\theta_k} & 0
\end{bmatrix} \\
\BTheta_k &=
\begin{bmatrix}
\theta_k \\
\phi_k
\end{bmatrix}.
\end{aligned}
\end{equation}
%
Since
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:740}
\frac{d\Bu_k}{dt} = \sum_{j = 1}^k l_j A_j^\T \dot{\Theta}_j,
\end{equation}
%
The squared velocity of each mass is
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:760}
\Abs{ \frac{d\Bu_k}{dt} }^2
=
\sum_{r,s = 1}^k
l_r
l_s
\dot{\Theta}_r^\T
A_r
A_s^\T \dot{\Theta}_s.
\end{dmath}
%
To see the structure of this product, it is helpful to expand this sum completely, something that is feasible for this \( N = 2 \) case.  First for \( k = 1 \) we have just
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:780}
\Abs{ \frac{d\Bu_1}{dt} }^2
=
l_1^2
\dot{\Theta}_1^\T
A_1
A_1^\T \dot{\Theta}_1,
\end{dmath}
%
and for \( k = 2 \) we have
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:800}
\Abs{ \frac{d\Bu_2}{dt} }^2
=
l_1^2
\dot{\Theta}_1^\T
A_1
A_1^\T \dot{\Theta}_1
+
l_2^2
\dot{\Theta}_2^\T
A_2
A_2^\T \dot{\Theta}_2
+
l_1
l_2
\dot{\Theta}_1^\T
A_1
A_2^\T \dot{\Theta}_2
+
l_2
l_1
\dot{\Theta}_2^\T
A_2
A_1^\T \dot{\Theta}_1
=
\lr{
l_1^2
\dot{\Theta}_1^\T
A_1
A_1^\T
+
l_2
l_1
\dot{\Theta}_2^\T
A_2
A_1^\T
} \dot{\Theta}_1
+
\lr{
l_2^2
\dot{\Theta}_2^\T
A_2
A_2^\T
+
l_1
l_2
\dot{\Theta}_1^\T
A_1
A_2^\T
} \dot{\Theta}_2
=
\begin{bmatrix}
\dot{\Theta}_1^\T & \dot{\Theta}_2^\T
\end{bmatrix}
\begin{bmatrix}
l_1^2
A_1
A_1^\T  \\
l_2
l_1
A_2
A_1^\T
\end{bmatrix}
\dot{\Theta}_1
+
\begin{bmatrix}
\dot{\Theta}_1^\T & \dot{\Theta}_2^\T
\end{bmatrix}
\begin{bmatrix}
l_1
l_2
A_1
A_2^\T  \\
l_2^2
A_2
A_2^\T  \\
\end{bmatrix}
\dot{\Theta}_2
=
\begin{bmatrix}
\dot{\Theta}_1^\T & \dot{\Theta}_2^\T
\end{bmatrix}
\begin{bmatrix}
l_1^2 A_1 A_1^\T & l_1 l_2 A_1 A_2^\T \\
l_2 l_1 A_2 A_1^\T & l_2^2 A_2 A_2^\T
\end{bmatrix}
\begin{bmatrix}
\dot{\Theta}_1 \\
\dot{\Theta}_2 \\
\end{bmatrix}
\end{dmath}
%
Observe that these can be summarized by writing
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:820}
\begin{aligned}
B_1^\T &=
\begin{bmatrix}
l_1 A_1^\T & 0
\end{bmatrix} \\
B_2^\T &=
\begin{bmatrix}
l_1 A_1^\T & l_2 A_2^\T
\end{bmatrix} \\
\Theta &= \begin{bmatrix}
\dot{\Theta}_1 \\
\dot{\Theta}_2 \\
\end{bmatrix} \\
\dot{\Bu}_k &=
\dot{\Theta}^\T
B_k B_k^\T
\dot{\Theta}
\end{aligned}
\end{equation}
%
The kinetic energy for particle one is
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:840}
K_1 = \inv{2} m_1
\dot{\Theta}^\T
B_1 B_1^\T
\dot{\Theta}
=
\dot{\Theta}^\T
\begin{bmatrix}
m_1 l_1^2
A_1
A_1^\T  & 0 \\
0 & 0
\end{bmatrix}
\dot{\Theta},
\end{dmath}
%
and for the second particle
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:860}
K_2 = \inv{2} m_2
\dot{\Theta}^\T
B_2 B_2^\T
\dot{\Theta}
=
\inv{2} m_2
\dot{\Theta}^\T
\begin{bmatrix}
l_1^2 A_1 A_1^\T & l_1 l_2 A_1 A_2^\T \\
l_2 l_1 A_2 A_1^\T & l_2^2 A_2 A_2^\T
\end{bmatrix}
\dot{\Theta}.
\end{dmath}
%
Summing these we have
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:880}
K =
\inv{2}
\dot{\Theta}^\T
\begin{bmatrix}
(m_1 + m_2) l_1^2 A_1 A_1^\T & m_2 l_1 l_2 A_1 A_2^\T \\
m_2 l_2 l_1 A_2 A_1^\T & m_2 l_2^2 A_2 A_2^\T
\end{bmatrix}
\dot{\Theta}.
\end{dmath}
%
For the mass sums let
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:900}
\mu_k \equiv \sum_{j=k}^2 m_j,
\end{dmath}
%
so
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:920}
K =
\inv{2}
\dot{\Theta}^\T
\begin{bmatrix}
\mu_1 l_1^2 A_1 A_1^\T & \mu_2 l_1 l_2 A_1 A_2^\T \\
\mu_2 l_2 l_1 A_2 A_1^\T & \mu_2 l_2^2 A_2 A_2^\T
\end{bmatrix}
\dot{\Theta}.
\end{dmath}
%
If the matrix of quadradic factors is designated \( Q \), so that
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:940}
K =
\inv{2}
\dot{\Theta}^\T Q
\dot{\Theta},
\end{dmath}
%
then the (i,j) element of the matrix Q is given by
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:960}
Q_{ij} =
\mu_{\max(i,j)} l_i l_j A_i A_j^\T.
\end{dmath}
%
For the potential energy, things are simplest if that energy is measured from the \( z = 0 \) plane.  The potential energy for mass 1 is
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:980}
T_1 = m_1 g l_1 \cos\theta_1,
\end{dmath}
%
and the potential energy for mass 2 is
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:1000}
T_2 = m_2 g \lr{
l_1 \cos\theta_1 +
l_2 \cos\theta_2
}.
\end{dmath}
%
The total potential energy for the system is
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:1020}
T
= (m_1 + m_2) g l_1 \cos\theta_1 + m_2 g l_2 \cos\theta_2
= \sum_{k = 1}^2 \mu_k g l_k \cos\theta_k.
\end{dmath}
%
\subsection{N spherical pendulum}
%
%4.  Make Section III as the meat of your article.  Divide this section into
%three parts: A.  Single pendulum, B. Double Pendulum, C. N-Pendulum.  Since you
%are not limited in the number of pages, subdivide each subsection into two: 1.
%standard method used in Goldstein and 2. Geometric Algebra method.  In this way
%the reader can readily compare and contrast the two methods.  You must show that
%the two methods are equivalent, so that there is an assurance that the physics
%is still correct despite the adoption of geometric algebra.
%
%
%%%\subsubsection{The Lagrangian}
%%%
%%%The position vector for each particle can be expressed relative to the mass it is connected to (or the origin for the first particle), as in
%%%
%%%Now, the relative velocity differential can be written utilizing these factors
%%%
%%%\begin{equation}\label{eqn:multiPendulumSphericalMatrix:360}
%%%\begin{aligned}
%%%(\dot{\Bu}_k - \dot{\Bu}_{k-1})^2 = l_k^2 {\dot{\BTheta}_k}^\T A_k A_k^\T \dot{\BTheta}_k.
%%%\end{aligned}
%%%\end{equation}
%%%
%%%Observe that the inner product is symmetric since \((A_k A_k^\T)^\T = A_k A_k^\T\).
%%%
%%%The normed velocity of the \(k\)th particle is then
%
Having written things out explicitly for the two particle case, the generalization to N particles is straightforward
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:370}
\begin{aligned}
\BTheta^\T &=
\begin{bmatrix}
\BTheta_1^\T &
\BTheta_2^\T &
\cdots &
\BTheta_N^\T
\end{bmatrix} \\
Q_{ij} &=
\mu_{\max(i,j)} l_i l_j A_i A_j^\T \\
K &= \inv{2} \dot{\Theta}^\T Q \dot{\Theta} \\
%B_k &=
%\begin{bmatrix}
%l_1 A_1 \\
%l_2 A_2 \\
%\vdots \\
%l_k A_k \\
%0 \\
%\end{bmatrix} \\
%(\dot{\Bu}_k)^2 &=
%\dot{\BTheta}^\T B_k B_k^\T \dot{\BTheta},
\mu_k &= \sum_{j=k}^N m_j \\
\Phi &=
g \sum_{k=1}^N \mu_k l_k \cos\theta_k \\
\LL &= K - \Phi.
\end{aligned}
\end{equation}
%
%%%where the zero matrix in \(B_k\) is a \(N-k\) by one zero.  Summing over all masses and adding in the potential energy we have for the Lagrangian of the system
%%%
%%%\begin{subequations}
%%%\begin{equation}\label{eqn:multiPendulumSphericalMatrix:380}
%%%\begin{aligned}
%%%K &=
%%%\inv{2} \sum_{k=1}^N m_k
%%%\dot{\BTheta}^\T
%%%B_k B_k^\T
%%%\dot{\BTheta} \\
%%%\end{aligned}
%%%\end{equation}
%%%\end{subequations}
%%%
%%%The kinetic energy expressed completely and explicitly as a symmetric quadratic form.
%%%
%%%\subsubsection{Some tidy up}
%%%
%%%Before continuing with evaluation of the Euler-Lagrange equations it is helpful to make a couple of observations about the structure of the matrix products that make up our velocity terms
%%%
%%%\begin{equation}\label{eqn:multiPendulumSphericalMatrix:390}
%%%\begin{aligned}
%%%\dot{\BTheta}^\T
%%%B_k B_k^\T
%%%\dot{\BTheta}
%%%&=
%%%\dot{\BTheta}^\T
%%%\begin{bmatrix}
%%%\begin{bmatrix}
%%%l_1^2 A_1 A_1^\T & l_1 l_2 A_1 A_2^\T & \hdots & l_1 l_k A_1 A_k^\T \\
%%%l_2 l_1 A_2 A_1^\T & l_2^2 A_2 A_2^\T & \hdots & l_2 l_k A_2 A_k^\T \\
%%%\vdots \\
%%%l_k l_1 A_k A_1^\T & l_k l_2 A_k A_2^\T & \hdots & l_k^2 A_k A_k^\T
%%%\end{bmatrix} & 0 \\
%%%0 & 0
%%%\end{bmatrix}
%%%\dot{\BTheta}.
%%%\end{aligned}
%%%\end{equation}
%%%
%%%Pulling in the summation over \(m_k\) we have
%%%
%%%\begin{equation}\label{eqn:multiPendulumSphericalMatrix:410}
%%%\begin{aligned}
%%%\sum_k m_k
%%%\dot{\BTheta}^\T
%%%B_k B_k^\T
%%%\dot{\BTheta}
%%%&=
%%%\dot{\BTheta}^\T
%%%{\begin{bmatrix}
%%%\mu_{\max(r,c)} l_r l_c \gpgradezeroNoOp{A_r A_c^\T}
%%%\end{bmatrix}}_{rc}
%%%\dot{\BTheta}.
%%%\end{aligned}
%%%\end{equation}
%%%
%%%It appears justifiable to label the \(\mu_{\max(r,c)} l_r l_c\) factors of the angular velocity matrices as moments of inertia in a generalized sense.  Using this block matrix form, and scalar selection, we can now write the Lagrangian in a slightly tidier form
%%%
%%%\begin{subequations}
%%%\begin{equation}\label{eqn:multiPendulumSphericalMatrix:420}
%%%\begin{aligned}
%%%\mu_k &= \sum_{j=k}^N m_j \\
%%%Q &=
%%%{\begin{bmatrix}
%%%\mu_{\max(r,c)} l_r l_c A_r A_c^\T
%%%\end{bmatrix}}_{rc} \\
%%%K &=
%%%\inv{2} \dot{\BTheta}^\T \gpgradezeroNoOp{Q}
%%%\dot{\BTheta} \\
%%%\Phi &=
%%%g \sum_{k=1}^N \mu_k l_k \cos\theta_k \\
%%%\LL &= K - \Phi.
%%%\end{aligned}
%%%\end{equation}
%%%\end{subequations}
%%%
After some expansion one can find that the block matrices \(A_i A_j^\T\) contained in \(Q\) are
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:430}
\begin{aligned}
\gpgradezeroNoOp{A_i A_j^\T}
=
\begin{bmatrix}
C_{\phi_j - \phi_i}
C_{\theta_i}
C_{\theta_j}
+S_{\theta_i}
S_{\theta_j} &
-S_{\phi_j - \phi_i} C_{\theta_i} S_{\theta_j} \\
S_{\phi_j - \phi_i} C_{\theta_j} S_{\theta_i} &
C_{\phi_j - \phi_i} S_{\theta_i} S_{\theta_j}
\end{bmatrix}.
\end{aligned}
\end{equation}
%
The diagonal blocks are particularly simple and have no \(\phi\) dependence
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:440}
\begin{aligned}
\gpgradezeroNoOp{A_i A_i^\T}
=
\begin{bmatrix}
1 & 0 \\
0 & \sin^2 \theta_i
\end{bmatrix}
\end{aligned}
\end{equation}
\section{Evaluating the Euler-Lagrange equations}
It will be convenient to group the Euler-Lagrange equations into a column vector form, with a column vector of generalized coordinates and derivatives, and position and velocity gradients in the associated phase space
\begin{subequations}
\label{eqn:multiPendulumSphericalMatrix:230}
\begin{dmath}
\Bq               \equiv {\begin{bmatrix} q_r \end{bmatrix}}_r
\end{dmath}
\begin{dmath}
\dot{\Bq}         \equiv {\begin{bmatrix} \dot{q}_r \end{bmatrix}}_r
\end{dmath}
\begin{dmath}
\grad_{\Bq} \LL   \equiv {\begin{bmatrix} \PD{q_r}{\LL} \end{bmatrix}}_r
\end{dmath}
\begin{dmath}
\grad_{\dot{\Bq}} \LL   \equiv {\begin{bmatrix} \PD{\dot{q}_r}{\LL} \end{bmatrix}}_r.
\end{dmath}
\end{subequations}
%
In this form the Euler-Lagrange equations take the form of a single vector equation
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:240}
\begin{aligned}
\grad_{\Bq} \LL   = \frac{d}{dt} \grad_{\dot{\Bq}} \LL.
\end{aligned}
\end{equation}
%
We are now set to evaluate these generalized phase space gradients.  For the acceleration terms our computation reduces nicely to a function of only \(\gpgradezeroNoOp{Q}\)
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:620}
\begin{aligned}
\frac{d}{dt} \PD{\dot{\theta}_a}{\LL}
&=
\inv{2} \frac{d}{dt}
\left(
\PD{\dot{\theta}_a}{\dot{\BTheta}}^\T
\gpgradezeroNoOp{Q}
\dot{\BTheta}
+
\dot{\BTheta}^\T
\gpgradezeroNoOp{Q}
\PD{\dot{\theta}_a}{\dot{\BTheta}}
\right)  \\
&=
\frac{d}{dt} \left(
{\begin{bmatrix}
\delta_{ac}
\begin{bmatrix}
1 & 0
\end{bmatrix}
\end{bmatrix}}_c
\gpgradezeroNoOp{Q}
\dot{\BTheta}
\right),
\end{aligned}
\end{equation}
%
and
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:640}
\begin{aligned}
\frac{d}{dt} \PD{\dot{\phi}_a}{\LL}
&=
\inv{2} \frac{d}{dt}
\left(
\PD{\dot{\phi}_a}{\dot{\BTheta}}^\T
\gpgradezeroNoOp{Q}
\dot{\BTheta}
+
\dot{\BTheta}^\T
\gpgradezeroNoOp{Q}
\PD{\dot{\phi}_a}{\dot{\BTheta}}
\right)  \\
&=
\frac{d}{dt} \left(
{\begin{bmatrix}
\delta_{ac}
\begin{bmatrix}
0 & 1
\end{bmatrix}
\end{bmatrix}}_c
\gpgradezeroNoOp{Q}
\dot{\BTheta}
\right).
\end{aligned}
\end{equation}
%
The last groupings above made use of \(\gpgradezeroNoOp{Q} = \gpgradezeroNoOp{Q}^\T\), and in particular \((\gpgradezeroNoOp{Q} + \gpgradezeroNoOp{Q}^\T)/2 = \gpgradezeroNoOp{Q}\).  We can now form a column matrix putting all the angular velocity gradient in a tidy block matrix representation
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:460}
\begin{aligned}
\grad_{\dot{\BTheta}} \LL =
{\begin{bmatrix}
\begin{bmatrix}
\PD{\dot{\theta}_r}{\LL} \\
\PD{\dot{\phi}_r}{\LL} \\
\end{bmatrix}
\end{bmatrix}}_r = \gpgradezeroNoOp{Q} \dot{\BTheta}.
\end{aligned}
\end{equation}
%
A small aside on Hamiltonian form.  This velocity gradient is also the conjugate momentum of the Hamiltonian, so if we wish to express the Hamiltonian in terms of conjugate momenta, we require invertability of \(\gpgradezeroNoOp{Q}\) at the point in time that we evaluate things.  Writing
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:470}
\begin{aligned}
P_{\BTheta} = \grad_{\dot{\BTheta}} \LL,
\end{aligned}
\end{equation}
%
and noting that \((\gpgradezeroNoOp{Q}^{-1})^\T = \gpgradezeroNoOp{Q}^{-1}\), we get for the kinetic energy portion of the Hamiltonian
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:480}
\begin{aligned}
K = \inv{2} {P_{\BTheta}}^\T \gpgradezeroNoOp{Q}^{-1} P_{\BTheta}.
\end{aligned}
\end{equation}
%
Now, the invertiblity of \(\gpgradezeroNoOp{Q}\) cannot be taken for granted.  Even in the single particle case we do not have invertiblity.  For the single particle case we have
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:490}
\begin{aligned}
\gpgradezeroNoOp{Q} =
m l^2
\begin{bmatrix}
1 & 0 \\
0 & \sin^2 \theta
\end{bmatrix},
\end{aligned}
\end{equation}
%
so at \(\theta = \pm \pi/2\) this quadratic form is singular, and the planar angular momentum becomes a constant of motion.
%
Returning to the evaluation of the Euler-Lagrange equations, the problem is now reduced to calculating the right hand side of the following system
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:500}
\begin{aligned}
\frac{d}{dt} \left( \gpgradezeroNoOp{Q} \dot{\BTheta} \right) =
{\begin{bmatrix}
\begin{bmatrix}
\PD{\theta_r}{\LL} \\
\PD{\phi_r}{\LL} \\
\end{bmatrix}
\end{bmatrix}}_r.
\end{aligned}
\end{equation}
%
With back substitution of \eqnref{eqn:multiPendulumSphericalMatrix:430}, and \eqnref{eqn:multiPendulumSphericalMatrix:440} we have a complete and explicit matrix expansion of the left hand side.  For the right hand side taking the \(\theta_a\) and \(\phi_a\) derivatives respectively we get
%
\begin{subequations}
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:510}
\begin{aligned}
\PD{\theta_a}{\LL}
=
\inv{2} \dot{\BTheta}^\T
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \left(
\PD{\theta_a}{A_r} A_c^\T
+A_r \PD{\theta_a}{A_c}^\T
\right)
\end{bmatrix}}_{rc}
\dot{\BTheta}
-g \mu_a l_a \sin\theta_a,
\end{aligned}
\end{equation}
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:520}
\begin{aligned}
\PD{\phi_a}{\LL}
=
\inv{2} \dot{\BTheta}^\T
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \left(
\PD{\phi_a}{A_r} A_c^\T
+A_r \PD{\phi_a}{A_c}^\T
\right)
\end{bmatrix}}_{rc}
\dot{\BTheta}.
\end{aligned}
\end{equation}
\end{subequations}
%
So to proceed we must consider the \(\gpgradezeroNoOp{A_r A_c^\T}\) partials.  A bit of thought shows that the matrices of partials above are mostly zeros.  Illustrating by example, consider \(\PDi{\theta_2}{\gpgradezeroNoOp{Q}}\), which in block matrix form is
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:530}
%\begin{aligned}
%\PD{\theta_2}{\gpgradezeroNoOp{Q}}
%=
\begin{bsmallmatrix}
0 & \inv{2} \mu_2 l_1 l_2 \gpgradezeroNoOp{A_1 \PD{\theta_2}{A_2}^\T} & 0 & \hdots & 0 \\
\inv{2} \mu_2 l_2 l_1 \gpgradezeroNoOp{\PD{\theta_2}{A_2} A_1^\T} &
\inv{2} \mu_2 l_2 l_2 \left(A_2 \PD{\theta_2}{A_2}^\T + \PD{\theta_2}{A_2} A_2^\T \right) &
\inv{2} \mu_3 l_2 l_3 \gpgradezeroNoOp{\PD{\theta_2}{A_2} A_3^\T} & \hdots &
\inv{2} \mu_N l_2 l_N \gpgradezeroNoOp{\PD{\theta_2}{A_2} A_N^\T} \\
0 & \inv{2} \mu_3 l_3 l_2 \gpgradezeroNoOp{A_3 \PD{\theta_2}{A_2}^\T} & 0 & \hdots & 0 \\
0 & \vdots & 0 & \hdots & 0 \\
0 & \inv{2} \mu_N l_N l_2 \gpgradezeroNoOp{A_N \PD{\theta_2}{A_2}^\T} & 0 & \hdots & 0 \\
\end{bsmallmatrix}.
%\end{aligned}
\end{equation}
%
Observe that the diagonal term has a scalar plus its transpose, so we can drop the one half factor and one of the summands for a total contribution to \(\PDi{\theta_2}{\LL}\) of just
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:660}
\begin{aligned}
\mu_2 {l_2}^2 {\dot{\BTheta}_2}^\T \gpgradezeroNoOp{\PD{\theta_2}{A_2} A_2^\T} \dot{\BTheta}_2.
\end{aligned}
\end{equation}
%
Now consider one of the pairs of off diagonal terms.  Adding these contributions to \(\PDi{\theta_2}{\LL}\) of
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:680}
\inv{2} \mu_2 l_1 l_2
{\dot{\BTheta}_1}^\T
\gpgradezeroNoOp{A_1 \PD{\theta_2}{A_2}^\T}
\dot{\BTheta}_2
+\inv{2} \mu_2 l_2 l_1
{\dot{\BTheta}_2}^\T
\gpgradezeroNoOp{\PD{\theta_2}{A_2} A_1^\T}
\dot{\BTheta}_1
=
\inv{2} \mu_2 l_1 l_2
{\dot{\BTheta}_1}^\T
\left(
A_1 \PD{\theta_2}{A_2}^\T
+A_1 \PD{\theta_2}{A_2}^\T
\right)
\dot{\BTheta}_2
=
\mu_2 l_1 l_2
{\dot{\BTheta}_1}^\T
\gpgradezeroNoOp{
A_1 \PD{\theta_2}{A_2}^\T
}
\dot{\BTheta}_2.
\end{dmath}
%
This has exactly the same form as the diagonal term, so summing over all terms we get for the position gradient components of the Euler-Lagrange equation just
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:540}
\begin{aligned}
\PD{\theta_a}{\LL}
&=
\sum_{k}
\mu_{\max(k,a)} l_k l_a
{\dot{\BTheta}_k}^\T
\gpgradezeroNoOp{
A_k \PD{\theta_a}{A_a}^\T
}
\dot{\BTheta}_a
-g \mu_a l_a \sin\theta_a,
\end{aligned}
\end{equation}
%
and
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:550}
\begin{aligned}
\PD{\phi_a}{\LL}
&=
\sum_{k}
\mu_{\max(k,a)} l_k l_a
{\dot{\BTheta}_k}^\T
\gpgradezeroNoOp{
A_k \PD{\phi_a}{A_a}^\T
}
\dot{\BTheta}_a.
\end{aligned}
\end{equation}
%
The only thing that remains to do is evaluate the \(\gpgradezeroNoOp{A_k \PDi{\phi_a}{A_a}^\T}\) matrices.
%
Utilizing \eqnref{eqn:multiPendulumSphericalMatrix:430}, one obtains easily
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:560}
\begin{aligned}
\gpgradezeroNoOp{ A_k \PD{\theta_r}{A_r}^\T }
&=
\begin{bmatrix}
%-C_{\phi_a - \phi_k} C_{\theta_k} S_{\theta_a} + S_{\theta_k} C_{\theta_a} &
%-S_{\phi_a - \phi_k} C_{\theta_k} C_{\theta_a} \\
%-S_{\phi_a - \phi_k} S_{\theta_a} S_{\theta_k} &
%C_{\phi_a - \phi_k} (1 + \delta_{k a}) S_{\theta_k} C_{\theta_a}
S_{\theta_k} C_{\theta_r} - C_{\theta_k} S_{\theta_r} C_{\phi_k - \phi_r} & C_{\theta_k} C_{\theta_r} S_{\phi_k - \phi_r} \\
S_{\theta_k} S_{\theta_r} S_{\phi_k - \phi_r} & S_{\theta_k} C_{\theta_r} C_{\phi_k - \phi_r}
\end{bmatrix},
\end{aligned}
\end{equation}
%
and
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:570}
\begin{aligned}
\gpgradezeroNoOp{ A_k \PD{\phi_r}{A_r}^\T }
&=
\begin{bmatrix}
%-S_{\phi_a - \phi_k} C_{\theta_k} C_{\theta_a} + S_{\theta_k} S_{\theta_a} &
%-C_{\phi_a - \phi_k} C_{\theta_k} S_{\theta_a} \\
%C_{\phi_a - \phi_k} C_{\theta_a} S_{\theta_k} &
%-S_{\phi_a - \phi_k} S_{\theta_k} S_{\theta_a}
C_{\theta_k} C_{\theta_r} S_{\phi_k - \phi_r} & - C_{\theta_k} S_{\theta_r} C_{\phi_k - \phi_r} \\
S_{\theta_k} C_{\theta_r} C_{\phi_k - \phi_r} & S_{\theta_k} S_{\theta_r} S_{\phi_k - \phi_r}
\end{bmatrix}.
\end{aligned}
\end{equation}
%
The right hand side of the Euler-Lagrange equations now becomes
%
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:580}
\begin{aligned}
\grad_{\BTheta} \LL =
\sum_k
{\begin{bmatrix}
\begin{bmatrix}
\mu_{\max(k,r)} l_k l_r {\dot{\BTheta}_k}^\T \gpgradezeroNoOp{ A_k \PD{\theta_r}{A_r}^\T } \dot{\BTheta}_r \\
\mu_{\max(k,r)} l_k l_r {\dot{\BTheta}_k}^\T \gpgradezeroNoOp{ A_k \PD{\phi_r}{A_r}^\T } \dot{\BTheta}_r
\end{bmatrix}
\end{bmatrix}}_r
- g
{\begin{bmatrix}
\mu_r l_r \sin\theta_r
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\end{bmatrix}}_r.
\end{aligned}
\end{equation}
%
Between \eqnref{eqn:multiPendulumSphericalMatrix:580}, \eqnref{eqn:multiPendulumSphericalMatrix:460}, and a few other auxiliary relations, all above we have completed the task of evaluating the Euler-Lagrange equations for this multiple particle distinct mass system.  Unfortunately, just as the simple planar pendulum is a non-linear system, so is this.  Possible options for solution are numerical methods or solution restricted to a linear approximation in a small neighborhood of a particular phase space point.
%
\section{Summary}
%
Looking back it is hard to tell the trees from the forest.  Here is a summary of the results and definitions of importance.  First the Langrangian itself
%
\begin{subequations}
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:420s}
\begin{aligned}
\mu_k &= \sum_{j=k}^N m_j \\
\BTheta_k &=
\begin{bmatrix}
\theta_k \\
\phi_k
\end{bmatrix} \\
\BTheta^\T &=
\begin{bmatrix}
\BTheta_1^\T &
\BTheta_2^\T &
\hdots &
\BTheta_N^\T \\
\end{bmatrix} \\
A_k
&=
\begin{bmatrix}
C_{\phi_k} C_{\theta_k} & S_{\phi_k} C_{\theta_k} & -S_{\theta_k} \\
- S_{\phi_k} S_{\theta_k} &   C_{\phi_k} S_{\theta_k} & 0
\end{bmatrix} \\
Q &=
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c A_r A_c^\T
\end{bmatrix}}_{rc} \\
K &=
\inv{2} \dot{\BTheta}^\T \gpgradezeroNoOp{Q}
\dot{\BTheta} \\
\Phi &=
g \sum_{k=1}^N \mu_k l_k \cos\theta_k \\
\LL &= K - \Phi.
\end{aligned}
\end{equation}
\end{subequations}
%
Evaluating the Euler-Lagrange equations for the system, we get
%
\begin{dmath}\label{eqn:multiPendulumSphericalMatrix:580s}
0 = \grad_{\BTheta} \LL - \frac{d}{dt} \left(\grad_{\dot{\BTheta}} \LL \right) =
\sum_k
{\begin{bmatrix}
\begin{bmatrix}
\mu_{\max(k,r)} l_k l_r {\dot{\BTheta}_k}^\T \gpgradezeroNoOp{ A_k \PD{\theta_r}{A_r}^\T } \dot{\BTheta}_r \\
\mu_{\max(k,r)} l_k l_r {\dot{\BTheta}_k}^\T \gpgradezeroNoOp{ A_k \PD{\phi_r}{A_r}^\T } \dot{\BTheta}_r
\end{bmatrix}
\end{bmatrix}}_r
- g
{\begin{bmatrix}
\mu_r l_r \sin\theta_r
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\end{bmatrix}}_r
-
\frac{d}{dt} \left(
\gpgradezeroNoOp{Q} \dot{\BTheta} \right)
.
\end{dmath}
%
Making this explicit requires evaluation of some of the matrix products.  With verification in \nbref{multisphericalPendulum.nb}, those are
%
%\begin{subequations}
\begin{equation}\label{eqn:multiPendulumSphericalMatrix:430s}
\begin{aligned}
\gpgradezeroNoOp{A_r A_c^\T}
&=
\begin{bmatrix}
C_{\phi_c - \phi_r}
C_{\theta_r}
C_{\theta_c}
+S_{\theta_r}
S_{\theta_c} &
-S_{\phi_c - \phi_r} C_{\theta_r} S_{\theta_c} \\
S_{\phi_c - \phi_r} C_{\theta_c} S_{\theta_r} &
C_{\phi_c - \phi_r} S_{\theta_r} S_{\theta_c}
\end{bmatrix} \\
\gpgradezeroNoOp{ A_k \PD{\theta_r}{A_r}^\T }
&=
\begin{bmatrix}
%-C_{\phi_r - \phi_k} C_{\theta_k} S_{\theta_r} + S_{\theta_k} C_{\theta_r} &
%-S_{\phi_r - \phi_k} C_{\theta_k} C_{\theta_r} \\
%-S_{\phi_r - \phi_k} S_{\theta_r} S_{\theta_k} &
%C_{\phi_r - \phi_k} (1 + \delta_{k r}) S_{\theta_k} C_{\theta_r}
S_{\theta_k} C_{\theta_r} - C_{\theta_k} S_{\theta_r} C_{\phi_k - \phi_r} & C_{\theta_k} C_{\theta_r} S_{\phi_k - \phi_r} \\
S_{\theta_k} S_{\theta_r} S_{\phi_k - \phi_r} & S_{\theta_k} C_{\theta_r} C_{\phi_k - \phi_r}
\end{bmatrix} \\
\gpgradezeroNoOp{ A_k \PD{\phi_r}{A_r}^\T }
&=
\begin{bmatrix}
%-S_{\phi_r - \phi_k} C_{\theta_k} C_{\theta_r} + S_{\theta_k} S_{\theta_r} &
%-C_{\phi_r - \phi_k} C_{\theta_k} S_{\theta_r} \\
%C_{\phi_r - \phi_k} C_{\theta_r} S_{\theta_k} &
%-S_{\phi_r - \phi_k} S_{\theta_k} S_{\theta_r}
C_{\theta_k} C_{\theta_r} S_{\phi_k - \phi_r} & - C_{\theta_k} S_{\theta_r} C_{\phi_k - \phi_r} \\
S_{\theta_k} C_{\theta_r} C_{\phi_k - \phi_r} & S_{\theta_k} S_{\theta_r} S_{\phi_k - \phi_r}
\end{bmatrix}.
\end{aligned}
\end{equation}
%\end{subequations}
%
%
\section{Conclusions and followup}
%
This treatment was originally formulated in terms of geometric algebra, and matrices of multivector elements were used in the derivation.  Being able to compactly specify 3D rotations in a polar form and then factor those vectors into multivector matrix products provides some interesting power, and leads to a structured approach that would perhaps not be obvious otherwise.

In such a formulation the system ends up with a natural Hermitian formulation, where the Hermitian conjugation operations is defined with the vector products reversed, and the matrix elements transposed.  Because the vector product is not commutative, some additional care is required in the handling and definition of such matrices, but that is not an insurmountable problem.

In retrospect it is clear that the same approach is possible with only matrices, and these notes are the result of ripping out all the multivector and geometric algebra references in a somewhat brute force fashion.  Somewhat sadly, the ``pretty'' geometric algebra methods originally being explored added some complexity to the problem that is not necessary.  It is common to find geometric algebra papers and texts show how superior the new non-matrix methods are, and the approach originally used had what was felt to an elegant synthesis of both matrix and GA methods.
%It is believed that there is still a great deal of potential in such a multivector matrix approach, even if, as in this case, such methods only provide the clarity to understand how to tackle the problem with traditional means.

%Because the goals changed in the process of assembling these notes, the reader is justified to complain that this stops prematurely.  Lots of math was performed, and then things just end.  There ought to be some followup herein to actually do some physics with the end results obtained.  Sorry about that.
%
%5.  Make section IV as your conclusions.  Write this in three paragraphs: (1)
%summary of what you did, (2) your conclusion stating the geometric algebra
%approach is indeed better than the standard approach and provide the reasons,
%and (3) give a recommendation for future work.
%
\index{spherical pendulum}
%\end{document}
