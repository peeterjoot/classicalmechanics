%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%
%\chapter{Notes on Goldstein's Routh's procedure}
\index{Routh's procedure}
\label{chap:goldsteinRouth}
%\blogpage{http://sites.google.com/site/peeterjoot/math2010/goldsteinRouth.pdf}
%\date{Mar 3, 2010}
%
\section{Motivation.}
%
Attempting study of \citep{goldstein1951cm} section 7-2 on Routh's procedure has been giving me some trouble.  It was not ``sinking in'', indicating a fundamental misunderstanding, or at least a requirement to work some examples.  Here I pick a system, the spherical pendulum, which has the required ignorable coordinate, to illustrate the ideas for myself with something less abstract.

We see that a first attempt to work such an example leads to the wrong result and the reasons for this are explored.
%
\section{Spherical pendulum example.}
%
The Lagrangian for the pendulum is
%
\begin{equation}\label{eqn:goldsteinRouth:1}
\LL = \inv{2} m r^2 \left( \dot{\theta}^2 + \dot{\phi}^2 \sin^2 \theta \right) - m g r ( 1 + \cos\theta ),
\end{equation}
%
and our conjugate momenta are therefore
%
\begin{equation}\label{eqn:goldsteinRouth:2}
\begin{aligned}
p_\theta &= \PD{\dot{\theta}}{\LL} = m r^2 \dot{\theta} \\
p_\phi &= \PD{\dot{\phi}}{\LL} = m r^2 \sin^2\theta \dot{\phi}.
\end{aligned}
\end{equation}
%
That is enough to now formulate the Hamiltonian \(H = \dot{\theta} p_\theta + \dot{\phi} p_\phi - \LL\), which is
%
\begin{equation}\label{eqn:goldsteinRouth:3}
H = H(\theta, p_\theta, p_\phi) = \inv{2 m r^2 } (p_\theta)^2 + \inv{2 m r^2 \sin^2\theta} (p_\phi)^2 + m g r ( 1 + \cos\theta ).
\end{equation}
%
We have got the ignorable coordinate \(\phi\) here, since the Hamiltonian has no explicit dependence on it.  In the Hamiltonian formalism the constant of motion associated with this comes as a consequence of evaluating the Hamiltonian equations.  For this system, those are
%
\begin{equation}\label{eqn:goldsteinRouth:4}
\begin{aligned}
\PD{\theta}{H} &= - \dot{p}_\theta \\
\PD{\phi}{H} &= - \dot{p}_\phi \\
\PD{p_\theta}{H} &= \dot{\theta} \\
\PD{p_\phi}{H} &= \dot{\phi},
\end{aligned}
\end{equation}
%
Or, explicitly,
\begin{equation}\label{eqn:goldsteinRouth:5}
\begin{aligned}
- \dot{p}_\theta &= -m g r \sin\theta - \frac{\cos\theta}{2 m r^2 \sin^3 \theta} (p_\phi)^2  \\
- \dot{p}_\phi &= 0 \\
\dot{\theta} &= \inv{m r^2 } p_\theta \\
\dot{\phi} &= \inv{m r^2 \sin^2 \theta} p_\phi.
\end{aligned}
\end{equation}
%
The second of these provides the integration constant, allowing us to write, \(p_\phi = \alpha\).  Once this is done, our Hamiltonian example is reduced to one complete set of conjugate coordinates,
%
\begin{equation}\label{eqn:goldsteinRouth:6}
H(\theta, p_\theta, \alpha) = \inv{2 m r^2 } (p_\theta)^2 + \inv{2 m r^2 \sin^2\theta} \alpha^2 + m g r ( 1 + \cos\theta ).
\end{equation}
%
Goldstein notes that the behavior of the cyclic coordinate follows by integrating
%
\begin{equation}\label{eqn:goldsteinRouth:7}
\dot{q}_n = \PD{\alpha}{H}.
\end{equation}
%
In this example \(\alpha = p_\theta\), so this is really just one of our Hamiltonian equations
%
\begin{equation}\label{eqn:goldsteinRouth:8}
\dot{\phi} = \PD{p_\phi}{H}.
\end{equation}
%
Okay, good.  First part of the mission is accomplished.  The setup for Routh's procedure no longer has anything mysterious to it.
%
Now, Goldstein defines the Routhian as
%
\begin{equation}\label{eqn:goldsteinRouth:9}
R = p_i \dot{q}_i - \LL,
\end{equation}
%
where the index \(i\) is summed only over the cyclic (ignorable) coordinates.  For this spherical pendulum example, this is \(q_i = \phi\), and \(p_i = m r^2 \sin^2 \theta \dot{\phi}\), for
%
\begin{equation}\label{eqn:goldsteinRouth:10}
R = \inv{2} m r^2 \left( -\dot{\theta}^2 + \dot{\phi}^2 \sin^2 \theta \right) + m g r ( 1 + \cos\theta ).
\end{equation}
%
Now, we should also have for the non-cyclic coordinates, just like the Euler-Lagrange equations
%
\begin{equation}\label{eqn:goldsteinRouth:11}
\PD{\theta}{R} = \frac{d}{dt} \PD{\dot{\theta}}{R}.
\end{equation}
%
Evaluating this we have
%
\begin{equation}\label{eqn:goldsteinRouth:12}
m r^2 \sin\theta \cos\theta \dot{\phi}^2 - m g r \sin\theta = \frac{d}{dt} \left( -m r^2 \dot{\theta} \right).
\end{equation}
%
It would be reasonable now to compare this the \(\theta\) Euler-Lagrange equations, but evaluating those we get
%
\begin{equation}\label{eqn:goldsteinRouth:13}
m r^2 \sin\theta \cos\theta \dot{\phi}^2 + m g r \sin\theta = \frac{d}{dt} \left( m r^2 \dot{\theta} \right).
\end{equation}
%
Bugger.  We have got a sign difference on the \(\dot{\phi}^2\) term.
%
\section{Simpler planar example.}
%
Having found an inconsistency with Routhian formalism and the concrete example of the spherical pendulum which has a cyclic coordinate as desired, let us step back slightly, and try a simpler example, artificially constructed
%
\begin{equation}\label{eqn:goldsteinRouth:20}
\LL = \inv{2} m (\dot{x}^2 + \dot{y}^2 ) - V(x).
\end{equation}
%
Our Hamiltonian and Routhian functions are
%
\begin{equation}\label{eqn:goldsteinRouth:21}
\begin{aligned}
H &= \inv{2} m (\dot{x}^2 + \dot{y}^2 ) + V(x) \\
R &= \inv{2} m (-\dot{x}^2 + \dot{y}^2 ) + V(x).
\end{aligned}
\end{equation}
%
For the non-cyclic coordinate we should have
%
\begin{equation}\label{eqn:goldsteinRouth:22}
\PD{x}{R} = \frac{d}{dt} \PD{\dot{x}}{R},
\end{equation}
%
which is
%
\begin{equation}\label{eqn:goldsteinRouth:23}
V'(x) = \frac{d}{dt}\left( - m \dot{x} \right)
\end{equation}
%
Okay, good, that is what is expected, and exactly what we get from the Euler-Lagrange equations.  This looks good, so where did things go wrong in the spherical pendulum evaluation.
%
\section{Polar form example.}
%
The troubles appear to come from when there is a velocity coupling in the Kinetic energy term.  Let us try one more example with a simpler velocity coupling, using polar form coordinates in the plane, and a radial potential.  Our Lagrangian, and conjugate momenta, and Hamiltonian, respectively are
%
\begin{equation}\label{eqn:goldsteinRouth:30}
\begin{aligned}
\LL &= \inv{2} m \left(\dot{r}^2 + r^2 \dot{\theta}^2 \right) - V(r) \\
p_r &= m \dot{r} \\
p_\theta &= m r^2 \dot{\theta} \\
H &= \inv{2 m} \left((p_r)^2 + \inv{r^2} (p_\theta)^2 \right) + V(r).
\end{aligned}
\end{equation}
%
Evaluation of the Euler-Lagrange equations gives us the equations of motion
%
\begin{equation}\label{eqn:goldsteinRouth:31}
\begin{aligned}
\frac{d}{dt}\left( m \dot{r} \right) &= m r \dot{\theta}^2 - V'(r) \\
\frac{d}{dt}\left( m r^2 \dot{\theta} \right) &= 0.
\end{aligned}
\end{equation}
%
Evaluation of the Hamiltonian equations \(\partial_p H = \dot{q}\), \(\partial_q H = -\dot{p}\) should give the same results.  First for \(r\) this gives
%
% dH/dp_r = r'
% dH/dr = -p_r'
% dH/dp_theta = theta'
% dH/dtheta = -p_theta'
\begin{equation}\label{eqn:goldsteinRouth:32}
\begin{aligned}
\inv{m} p_r &= \dot{r} \\
-\inv{m r^3} (p_\theta)^2 + V'(r) &= -\dot{p}_r.
\end{aligned}
\end{equation}
%
The first just defines the canonical momentum (in this case the linear momentum for the radial aspect of the motion), and the second after some rearrangement is
%
\begin{equation}\label{eqn:goldsteinRouth:33}
\begin{aligned}
m r (\dot{\theta})^2 - V'(r) &= \frac{d}{dt}\left( m \dot{r} \right),
\end{aligned}
\end{equation}
%
which is consistent with the Lagrangian approach.  For the \(\theta\) evaluation of the Hamiltonian equations we get
%
% dH/dp_theta = theta'
% dH/dtheta = -p_theta'
\begin{equation}\label{eqn:goldsteinRouth:34}
\begin{aligned}
\frac{p_\theta}{m r^2} &= \dot{\theta} \\
0 &= -\dot{p}_\theta.
\end{aligned}
\end{equation}
%
The first again, is implicitly, the definition of our canonical momentum (angular momentum in this case), while the second is the conservation condition on the angular momentum that we expect associated with this ignorable coordinate.  So far so good.  Everything is as it should be, and there is nothing new here.  Just Lagrangian and Hamiltonian mechanics as usual.  But we have two independently calculated results that are the same and the Routhian procedure should generate the same results.

Now, on to the Routhian.  There we have a Hamiltonian like sum of \(p \dot{q}\) terms over all cyclic coordinates, minus the Lagrangian.  Here the \(\theta\) coordinate is observed to be that cyclic coordinate, so this is
%
\begin{equation}\label{eqn:goldsteinRouth:60}
\begin{aligned}
R
&= p_\theta \dot{\theta} - \LL \\
&= m r^2 \dot{\theta}^2 - \inv{2} m \left(\dot{r}^2 + r^2 \dot{\theta}^2 \right) + V(r) \\
&= \inv{2} m r^2 \dot{\theta}^2 - \inv{2} m \dot{r}^2 + V(r).
\end{aligned}
\end{equation}
%
Now, this Routhian can be written in a few different ways.  In particular for the \(\dot{\theta}\) dependent term of the kinetic energy we can write
%
\begin{equation}\label{eqn:goldsteinRouth:35}
\inv{2} m r^2 \dot{\theta}^2 = \inv{2 m r^2 } (p_\theta)^2 = \inv{2 } \dot{\theta} p_\theta
\end{equation}
%
Looking at the troubles obtaining the correct equations of motion from the Routhian, it appears likely that this freedom is where things go wrong.  In the Cartesian coordinate description, where there was no coupling between the coordinates in the kinetic energy we had no such freedom.  Looking back to Goldstein, I see that he writes the Routhian in terms of a set of explicit variables
%
\begin{equation}\label{eqn:goldsteinRouth:36}
R = R(q_1, \cdots q_n, p_1, \cdots p_s, \dot{q}_{s+1}, \cdots \dot{q}_n, t) = \sum_{i=1}^{s} \dot{q}_i p_i - \LL
\end{equation}
%
where \(q_1, \cdots q_s\) were the cyclic coordinates.  Additionally, taking the differential he writes
%
\begin{equation}\label{eqn:goldsteinRouth:37}
\begin{aligned}
dR &=
  \sum_{i=1}^{s} \dot{q}_i dp_i
- \sum_{i=1}^s \PD{q_i}{\LL} dq_i
- \sum_{i=1}^n \PD{\dot{q}_i}{\LL} d\dot{q}_i
- \PD{t}{\LL} dt \\
&=
\PD{p_i}{R} dp_i
+ \PD{q_i}{R} dq_i
+ \PD{\dot{q}_i}{R} d\dot{q}_i
+ \PD{t}{R} dt,
\end{aligned}
\end{equation}
%
with sums implied in the second total differential.  It was term by term equivalence of these that led to the Routhian equivalent of the Euler-Lagrange equations for the non-cyclic coordinates, from which we should recover the desired equations of motion.  Notable here is that we have no \(\dot{q}_i\) for any of the cyclic coordinates \(q_i\).

For this planar radial Lagrangian, it appears that we must write the Routhian, specifically as \(R = R(r, \theta, p_\theta, \dot{r})\), so that we have no explicit dependence on the radial conjugate momentum.  That is
%
\begin{equation}\label{eqn:goldsteinRouth:38}
\begin{aligned}
R &=
\inv{2 m r^2} (p_\theta)^2 - \inv{2} m \dot{r}^2 + V(r).
\end{aligned}
\end{equation}
%
As a consequence of \eqnref{eqn:goldsteinRouth:37} we should recover the equations of motion by evaluating \(\delta R/\delta r = 0\), and doing so for \eqnref{eqn:goldsteinRouth:38} we have
%
\begin{equation}\label{eqn:goldsteinRouth:39}
\frac{\delta R}{\delta r} = V'(r) - \inv{m r^3} (p_\theta)^2 - \frac{d}{dt}\left( -m \dot{r} \right) = 0.
\end{equation}
%
Good.  This agrees with our result from the Lagrangian and Hamiltonian formalisms.  On the other hand, if we evaluate this variational derivative for
%
\begin{equation}\label{eqn:goldsteinRouth:40}
\begin{aligned}
R &= \inv{2} m r^2 \dot{\theta}^2 - \inv{2} m \dot{r}^2 + V(r),
\end{aligned}
\end{equation}
%
something that is formally identical, but written in terms of the ``wrong'' variables, we get a result that is in fact wrong
%
\begin{equation}\label{eqn:goldsteinRouth:39b}
\frac{\delta R}{\delta r} = m r \dot{\theta}^2 + V'(r) - \frac{d}{dt}\left( -m \dot{r} \right) = 0.
\end{equation}
%
Here the term that comes from the \(\dot{\theta}\) dependent part of the Kinetic energy has an incorrect sign.  This was precisely the problem observed in the initial attempt to work the spherical pendulum equations of motion starting from the Routhian.

What variables to use to express the equations is a rather subtle difference, but if we do not get that exactly right the results are garbage.  Next step here is go back and revisit the spherical polar pendulum and verify that being more careful with the variables used to express \(R\) allows the correct answer to be obtained.  That exercise is probably for a different day, and probably a paper only job.

Now, I note that Goldstein includes no problems for this Routhian formalism now that I look, and having worked an example successfully and seeing how we can go wrong, it is not quite clear what his point including this was.  Perhaps that will become clearer later.  I had guess that some of the value of this formalism could be once one attempts numerical solutions and finds the cyclic coordinates as a result of a linear approximation of the system equations around the neighborhood of some phase space point.
