%
% Copyright Â© 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeoproblem{Angular momentum conservation of three particle system.}{gold:ch1:pr8}{\citep{goldstein1951cm} 1.8}{
A system is composed of three particles of equal mass m.  Between any two of them there are forces derivable from a potential
%
\begin{equation}\label{eqn:goldsteinCh12:1060}
V = -g e^{-\mu r},
\end{equation}
%
where \(r\) is the distance between the two particles.  In addition, two of the particles each exert a force on the third which can be obtained from a generalized potential of the form
%
\begin{equation}\label{eqn:goldsteinCh12:1080}
U = -f \Bv \cdot \Br,
\end{equation}
%
\(\Bv\) being the relative velocity of the interacting particles and f a constant.  Set up the Lagrangian for the system, using as coordinates the radius vector \(\BR\) of the center of mass and the two vectors
%
\begin{equation}\label{eqn:goldsteinCh12:100}
\begin{aligned}
\Brho_1 &= \Br_1 - \Br_3 \\
\Brho_2 &= \Br_2 - \Br_3.
\end{aligned}
\end{equation}
%
Is the total angular momentum of the system conserved?
}
%
\makeanswer{gold:ch1:pr8}{
The center of mass vector is:
%
\begin{equation}\label{eqn:goldsteinCh12:1100}
\BR = \inv{3}(\Br_1 + \Br_2 + \Br_3).
\end{equation}
%
This can be used to express each of the position vectors in terms of the \(\Brho_i\) vectors:
%
\begin{equation}\label{eqn:goldsteinCh12:120}
\begin{aligned}
3 m \BR &= m (\Brho_1 + \Br_3) + m(\Brho_2 + \Br_3) + m \Br_3 \\
        &= 2 m (\Brho_1 + \Brho_2) + 3 m \Br_3 \\
  \Br_3 &= \BR - \inv{3}(\Brho_1 + \Brho_2) \\
\Br_2 = \Brho_2 + \Br_3 &= \Brho_2 + \Br_3 = \frac{2}{3} \Brho_2 - \inv{2} \Brho_1 + \BR \\
\Br_1 = \Brho_1 + \Br_3 &= \frac{2}{3} \Brho_1 - \inv{2} \Brho_2 + \BR .
\end{aligned}
\end{equation}
%
Now, that is enough to specify the part of the Lagrangian from the potentials that act between all the particles
%
\begin{equation}\label{eqn:goldsteinCh12:1120}
\LL_V = \sum -V_{ij} = g \left( e^{-\mu \Abs{\Brho_1}} + e^{-\mu \Abs{\Brho_2}} + e^{-\mu \Abs{ \Brho_1 - \Brho_2 }} \right).
\end{equation}
%
Now, we need to calculate the two \(U\) potential terms.  If we consider with positions \(\Br_1\), and \(\Br_2\) to be the ones
that can exert a force on the third, the velocities of those masses relative to \(\Br_3\) are:
%
\begin{equation}\label{eqn:goldsteinCh12:1140}
(\Br_3 - \Br_k)' = \dot{\Brho_k}.
\end{equation}
%
So, the potential parts of the Lagrangian are
%Adding this to the first half of the Lagrangian we have:
%So, for the second half of the Lagrangian we have:
%
\begin{equation}\label{eqn:goldsteinCh12:1160}
\LL_{U+V} =
g \left( e^{-\mu \Abs{\Brho_1}} + e^{-\mu \Abs{\Brho_2}} + e^{-\mu \Abs{ \Brho_1 - \Brho_2 }} \right)
+ f \left(\BR - \inv{3}(\Brho_1 + \Brho_2) \right) \cdot \left( \dot{\Brho_1} + \dot{\Brho_2} \right).
\end{equation}
%
The kinetic part (omitting the m/2 factor), in terms of the CM and relative vectors is
%
\begin{equation}\label{eqn:goldsteinCh12:140}
\begin{aligned}
%\inv{2}m
%\left(
(\Bv_1)^2
&+(\Bv_2)^2
+(\Bv_3)^2 %\right)
= \left(\frac{2}{3} \dot{\Brho}_1 - \inv{2} \dot{\Brho}_2 + \dot{\BR}\right)^2
+ \left(\frac{2}{3} \dot{\Brho}_2 - \inv{2} \dot{\Brho}_1 + \dot{\BR}\right)^2  \\
&\quad+ \left(\dot{\BR} - \inv{3}(\dot{\Brho}_1 + \dot{\Brho}_2)\right)^2 \\
&=
 3 \dot{\BR}^2 + (5/9 + 1/4) ((\dot{\Brho}_1)^2 + (\dot{\Brho}_2)^2 ) \\
&+ 2 (-2/3 + 1/9) \dot{\Brho}_1 \cdot \dot{\Brho}_1
+ 2 (1/3-1/2) (\dot{\Brho}_1 + \dot{\Brho}_2) \cdot \dot{\BR}  .
\end{aligned}
\end{equation}
%
So the Kinetic part of the Lagrangian is
%
\begin{equation}\label{eqn:goldsteinCh12:160}
\LL_K = \frac{3m}{2} \dot{\BR}^2 + \frac{29 m}{72} ((\dot{\Brho}_1)^2 + (\dot{\Brho}_2)^2 )
- \frac{5 m}{9} \dot{\Brho}_1 \cdot \dot{\Brho}_2
- \frac{m}{6} (\dot{\Brho}_1 + \dot{\Brho}_2) \cdot \dot{\BR}  .
\end{equation}
%
and finally, the total Lagrangian is
%
\begin{dmath}\label{eqn:goldsteinCh12:180}
\LL =
\frac{3m}{2} \dot{\BR}^2 + \frac{29 m}{72} ((\dot{\Brho}_1)^2 + (\dot{\Brho}_2)^2 )
- \frac{5 m}{9} \dot{\Brho}_1 \cdot \dot{\Brho}_2
- \frac{m}{6} (\dot{\Brho}_1 + \dot{\Brho}_2) \cdot \dot{\BR}  
+g \left( e^{-\mu \Abs{\Brho_1}} + e^{-\mu \Abs{\Brho_2}} + e^{-\mu \Abs{ \Brho_1 - \Brho_2 }} \right)
+ f \left(\BR - \inv{3}(\Brho_1 + \Brho_2) \right) \cdot \left( \dot{\Brho_1} + \dot{\Brho_2} \right).
\end{dmath}
%
\paragraph{Angular momentum conservation?}
%
How about the angular momentum conservation question?  How to answer that?  One way would be to compute the forces from the Lagrangian, and take cross products but is that really the best way?  Perhaps the answer is as simple as observing that there are no external torque's on the system, thus \(d\BL/dt = 0\), or angular momentum for the system is constant (conserved).  Is that actually the case
with these velocity dependent potentials?
%
It was suggested to me on PF that I should look at how this Lagrangian transforms under rotation, and use Noether's theorem.
The Goldstein book does not explicitly mention this theorem that I can see, and I do not think it was covered yet if it did.
%
Suppose we did know about Noether's theorem for this problem (as I now do with
in this revisiting of this problem to complete it), we would have to
see if the Lagrangian is invariant under rotation.  Suppose that a rigid rotation is introduced, which we can write in GA
formalism using dual sided quaternion products
%
\begin{equation}\label{eqn:goldsteinCh12:200}
\Bx \rightarrow \Bx' = e^{-i\ncap \alpha/2} \Bx e^{i\ncap\alpha/2}.
\end{equation}
%
(could probably also use a matrix formulation, but the parametrization is messier).
%
For all the relative vectors \(\Brho_k\) we have
\begin{equation}\label{eqn:goldsteinCh12:220}
\Abs{\Brho_k'} = \Abs{\Brho_k}.
\end{equation}
So all the \(V\) potential interactions are invariant.
%
Since the rotation quaternion here is a fixed non-time dependent quantity we have
\begin{equation}\label{eqn:goldsteinCh12:240}
\dot{\Brho}_k' = e^{-i\ncap \alpha/2} \dot{\Brho}_k e^{i\ncap\alpha/2},
\end{equation}
so for the dot product in the remaining potential term we have
\begin{equation}\label{eqn:goldsteinCh12:260}
\begin{aligned}
&\left( \BR' - \inv{3}\left(\Brho_1' + \Brho_2'\right) \right) \cdot \left({\dot{\Brho}}_1' + {\dot{\Brho}}_2'\right) \\
&\quad=
\left(e^{-i\ncap \alpha/2} \left( \BR - \inv{3}\left(\Brho_1 + \Brho_2\right) \right) e^{i\ncap\alpha/2}\right) \cdot
\left(e^{-i\ncap \alpha/2} \dot{\Brho}_1 + \dot{\Brho_2} e^{i\ncap\alpha/2}\right) \\
&\quad=
\gpgradezero{
e^{-i\ncap \alpha/2} \left( \BR - \inv{3}\left(\Brho_1 + \Brho_2\right) \right) e^{i\ncap\alpha/2}
e^{-i\ncap \alpha/2} \dot{\Brho}_1 + \dot{\Brho_2} e^{i\ncap\alpha/2}
} \\
&\quad=
\gpgradezero{
e^{-i\ncap \alpha/2} \left( \BR - \inv{3}\left(\Brho_1 + \Brho_2\right) \right) \left(\dot{\Brho}_1 + \dot{\Brho_2}\right) e^{i\ncap\alpha/2}
} \\
&\quad=
\gpgradezero{
e^{i\ncap\alpha/2}
e^{-i\ncap \alpha/2} \left( \BR - \inv{3}\left(\Brho_1 + \Brho_2\right) \right) \left(\dot{\Brho}_1 + \dot{\Brho_2}\right)
} \\
&\quad=
\gpgradezero{
\left( \BR - \inv{3}\left(\Brho_1 + \Brho_2\right) \right) \left(\dot{\Brho}_1 + \dot{\Brho_2}\right)
} \\
&\quad=
\left( \BR - \inv{3}\left(\Brho_1 + \Brho_2\right) \right) \cdot \left(\dot{\Brho}_1 + \dot{\Brho_2}\right).
\end{aligned}
\end{equation}
%
So, presuming I interpreted the \(\Br\) in \(\Bv \cdot \Br\) correctly,
all the vector quantities in the Lagrangian are rotation invariant, and by Noether's we should have system angular momentum
conservation.
%
\paragraph{Application of Noether's.}
Invoking Noether's here seems like cheating, at least without computing the conserved current, so let us do this.
%  Should try something more direct here for comparision.  As a bare minimum the conserved current should
%also be computed (which should be the angular momentum).
%
%\subsection{Evaluate the equations of motion}
%
To make this easier, suppose we generalize the Lagrangian slightly to get rid of all the peculiar and specific numerical constants.  Let
\(\rho_3 = \BR\), then our Lagrangian has the functional form
%
\begin{equation}\label{eqn:goldsteinCh12:280}
\LL = \alpha^{ij} \dot{\Brho}_i \cdot \dot{\Brho}_j
+ g^i e^{-\mu \Abs{\Brho_i}}
+ g^{ij} e^{-\mu \Abs{ \Brho_i - \Brho_j }}
+ f^i \Brho_i \cdot ( \dot{\Brho}_1 + \dot{\Brho}_2 ).
\end{equation}
%
We can then pick specific \(\alpha^{ij}\), \(f^{i}\), and \(g^{ij}\) (not all non-zero), to match the Lagrangian of this problem.
This could be expanded in terms of coordinates, producing nine generalized coordinates and nine corresponding velocity terms, but
since our Lagrangian transformation is so naturally expressed in vector form this does not seem like a reasonable thing to do.
%
Let us step up the abstraction one more level instead and treat the Noether symmetry in the more general case, supposing that we have
a Lagrangian that is invariant under the same rotational transformation applied above, but has the following general form with explicit
vector parametrization, where as above, all our vectors come in functions of the dot products (either explicit or implied by
absolute values) of our vectors or their time derivatives
%
\begin{equation}\label{eqn:goldsteinCh12:300}
\LL = f( {\Bx_k} \cdot {{\Bx}_j}, {\Bx_k} \cdot {\dot{\Bx}_j}, {\dot{\Bx}_k} \cdot {\dot{\Bx}_j} ).
\end{equation}
%
Having all the parametrization being functions of dot products gives the desired rotational symmetry for the Lagrangian.
This must be however, not a dot product with an arbitrary vector, but one of the generalized vector parameters of the Lagrangian.
Something like the \(\BA \cdot \Bv\) term in the Lorentz force Lagrangian does not have this invariance since \(\BA\) does not transform
along with \(\Bv\).  Also Note that the absolute values of the \(\Brho_k\) vectors are functions of dot products.
%
Now we are in shape to compute the conserved ``current'' for a rotational symmetry.  Our vectors and their derivatives are explicitly rotated
%
\begin{equation}\label{eqn:goldsteinCh12:320}
\begin{aligned}
{\Bx}_k' &= e^{-i\ncap \alpha/2} {\Bx}_k e^{i\ncap\alpha/2} \\
\dot{\Bx}_k' &= e^{-i\ncap \alpha/2} \dot{\Bx}_k e^{i\ncap\alpha/2},
\end{aligned}
\end{equation}
%
and our Lagrangian is assumed, as above with all vectors coming in dot product pairs, to have rotational invariance when all the vectors in the system are rotated
%
\begin{equation}\label{eqn:goldsteinCh12:340}
\LL  \rightarrow \LL'(\Bx_k', \dot{\Bx}_j') = \LL(\Bx_k, \dot{\Bx}_j) .
\end{equation}
%
The essence of Noether's theorem was applied chain rule, looking at how the transformed Lagrangian changes with respect to the transformation.  In this case
we want to calculate
%
\begin{equation}\label{eqn:goldsteinCh12:360}
{\left. \frac{d \LL'}{d\alpha} \right\vert}_{\alpha=0}.
\end{equation}
%
First seeing the Noether's derivation, I did not understand why the evaluation at \(\alpha=0\) was required, even after doing this
derivation for myself in \bookchapcite{PJEulerLagrange}{phy354} (after an initial botched attempt), but
the reason for it actually became clear with this application, as writing it up will show.
%
Anyways, back to the derivative.  One way to evaluate this would be in terms of coordinates, writing \(\Bx_k' = \Be^m x_{km}'\),
%
\begin{equation}\label{eqn:goldsteinCh12:380}
\frac{d \LL'}{d\alpha} (\Bx_k', \dot{\Bx}_j')
= \sum_{k,m} \frac{\partial \LL'}{\partial x_{km}'} \PD{\alpha}{x_{km}'} + \frac{\partial \LL'}{\partial \dot{x}_{km}'} \PD{\alpha}{\dot{x}_{km}'} .
\end{equation}
%
This is a bit of a mess however, and begs for some shorthand.  Let us write
%
\begin{equation}\label{eqn:goldsteinCh12:400}
\begin{aligned}
\spacegrad_{\Bx_k'} \LL' &= e^m \frac{\partial \LL'}{\partial x_{km}'} \\
\spacegrad_{\dot{\Bx}_k'} \LL' &= e^m \frac{\partial \LL'}{\partial \dot{x}_{km}'}.
\end{aligned}
\end{equation}
%
Then the chain rule application above becomes
%
\begin{equation}\label{eqn:goldsteinCh12:420}
\frac{d \LL'}{d\alpha} (\Bx_k', \dot{\Bx}_j')
= \sum_{k} \left( \spacegrad_{\Bx_k'} \LL'\right) \cdot \PD{\alpha}{\Bx_k'} + \left( \spacegrad_{\dot{\Bx}_k'} \LL' \right) \cdot \PD{\alpha}{\dot{\Bx}_k'} .
\end{equation}
%
Now, while this notational sugar unfortunately has an obscuring effect, it is also practical since we can now work with the transformed position
and velocity vectors directly
%
\begin{equation}\label{eqn:goldsteinCh12:440}
\begin{aligned}
\PD{\alpha}{\Bx_k'}
&= (-i \ncap/2) e^{-i\ncap \alpha/2} {\Bx}_k e^{i\ncap\alpha/2} +e^{-i\ncap \alpha/2} {\Bx}_k e^{i\ncap\alpha/2} (i \ncap/2)  \\
&= (-i \ncap/2) \Bx_k' + \Bx_k' (i \ncap/2) \\
&= i (\ncap \wedge \Bx_k').
\end{aligned}
\end{equation}
%
So we have
\begin{equation}\label{eqn:goldsteinCh12:460}
\frac{d \LL'}{d\alpha} (\Bx_k', \dot{\Bx}_j')
= \sum_{k} \left( \spacegrad_{\Bx_k'} \LL'\right) \cdot \left( i (\ncap \wedge \Bx_k') \right)
+ \sum_{k} \left( \spacegrad_{\dot{\Bx}_k'} \LL'\right) \cdot \left( i (\ncap \wedge \dot{\Bx}_k') \right) .
\end{equation}
%
Next step is to reintroduce the notational sugar noting that we can vectorize the Euler-Lagrange equations by writing
%
\begin{equation}\label{eqn:goldsteinCh12:480}
\spacegrad_{\Bx_k} \LL = \frac{d}{dt} \spacegrad_{\dot{\Bx}_k} \LL.
\end{equation}
%
We have now a three fold reduction in the number of Euler-Lagrange equations.  For each of the generalized vector parameters, we have the
Lagrangian gradient with respect to that vector parameter (a generalized force) equals the time rate of change of the velocity gradient.
%
Inserting this we have
\begin{equation}\label{eqn:goldsteinCh12:500}
\frac{d \LL'}{d\alpha} (\Bx_k', \dot{\Bx}_j')
= \sum_{k} \left( \frac{d}{dt} \spacegrad_{\dot{\Bx}_k'} \LL'\right) \cdot \left( i (\ncap \wedge \Bx_k') \right)
+ \sum_{k} \left( \spacegrad_{\dot{\Bx}_k'} \LL'\right) \cdot \left( i (\ncap \wedge \dot{\Bx}_k') \right) .
\end{equation}
%
Now we can drop the primes in gradient terms because of the Lagrangian invariance for this symmetry, and are left almost with a
perfect differential
%
\begin{equation}\label{eqn:goldsteinCh12:520}
\frac{d \LL'}{d\alpha} (\Bx_k', \dot{\Bx}_j')
= \sum_{k} \left( \frac{d}{dt} \spacegrad_{\dot{\Bx}_k} \LL\right) \cdot \left( i (\ncap \wedge \Bx_k') \right)
+ \sum_{k} \left( \spacegrad_{\dot{\Bx}_k} \LL\right) \cdot \left( i (\ncap \wedge \dot{\Bx}_k') \right) .
\end{equation}
%
Here is where the evaluation at \(\alpha=0\) comes in, since \(\Bx_k'(\alpha=0) = \Bx_k\), and we can now antidifferentiate
%
\begin{equation}\label{eqn:goldsteinCh12:540}
\begin{aligned}
{\left. \frac{d \LL'}{d\alpha} (\Bx_k', \dot{\Bx}_j') \right\vert}_{\alpha=0}
&= \sum_{k} \left( \frac{d}{dt} \spacegrad_{\dot{\Bx}_k} \LL\right) \cdot \left( i (\ncap \wedge \Bx_k) \right)
+ \sum_{k} \left( \spacegrad_{\dot{\Bx}_k} \LL\right) \cdot \left( i (\ncap \wedge \dot{\Bx}_k) \right) \\
&= \sum_{k} \frac{d}{dt} \left( \left( \spacegrad_{\dot{\Bx}_k} \LL\right) \cdot \left( i (\ncap \wedge \Bx_k) \right) \right) \\
&= \sum_{k} \frac{d}{dt} \gpgradezero{ \left( \spacegrad_{\dot{\Bx}_k} \LL \right) i (\ncap \wedge \Bx_k) } \\
&= \sum_{k} \frac{d}{dt} \inv{2} \gpgradezero{ \left( \spacegrad_{\dot{\Bx}_k} \LL \right) i (\ncap \Bx_k - \Bx_k \ncap) } \\
&= \sum_{k} \frac{d}{dt} \inv{2} \gpgradezero{
\ncap i \left( \Bx_k \left( \spacegrad_{\dot{\Bx}_k} \LL \right) -  \left( \spacegrad_{\dot{\Bx}_k} \LL \right) \Bx_k \right)
} \\
&= \sum_{k} \frac{d}{dt} \inv{2} \gpgradezero{
\ncap i \left( \Bx_k \left( \spacegrad_{\dot{\Bx}_k} \LL \right) -  \left( \spacegrad_{\dot{\Bx}_k} \LL \right) \Bx_k \right)
} \\
&= \sum_{k} \frac{d}{dt} \gpgradezero{
\ncap i \left(\Bx_k \wedge \left( \spacegrad_{\dot{\Bx}_k} \LL \right) \right)
} \\
&= \sum_{k} \frac{d}{dt} \gpgradezero{
\ncap i^2 \left(\Bx_k \cross \left( \spacegrad_{\dot{\Bx}_k} \LL \right) \right)
} \\
&= \sum_{k} \frac{d}{dt} -\ncap \cdot \left(\Bx_k \cross \left( \spacegrad_{\dot{\Bx}_k} \LL \right) \right) .
\end{aligned}
\end{equation}
%
Because of the symmetry this entire derivative is zero, so we have
%
\begin{equation}\label{eqn:goldsteinCh12:560}
\ncap \cdot \sum_{k} \left(\Bx_k \cross \left( \spacegrad_{\dot{\Bx}_k} \LL \right) \right) = \text{constant}.
\end{equation}
%
The Lagrangian velocity gradient can be identified as the momentum
(ie: the canonical momentum conjugate to \(\Bx_k\))
%
\begin{equation}\label{eqn:goldsteinCh12:580}
\Bp_k \equiv \spacegrad_{\dot{\Bx}_k} \LL.
\end{equation}
%
Also noting that this is constant for any \(\ncap\), we finally have the
conserved ``current'' for a rotational symmetry of a system of particles
%
\begin{equation}\label{eqn:goldsteinCh12:600}
\sum_{k} \Bx_k \cross \Bp_k = \text{constant}.
\end{equation}
%
This digression to Noether's appears to be well worth it for answering the angular momentum question of the problem.  Glibly saying ``yes
angular momentum is conserved'', just because the Lagrangian has a rotational symmetry is not enough.  We have seen in this particular
problem that the Lagrangian, having only dot products has the rotational symmetry, but because of the velocity dependent
potential terms \(f^i \dot{\Brho}_k \cdot \dot{\Brho}_j\), the normal Kinetic energy momentum vectors are not equal to the canonical conjugate
momentum vectors.  Only when the angular momentum is generalized, and written in terms of the canonical conjugate momentum is the total
system angular momentum conserved.  Namely, the generalized angular momentum for this problem is conserved
%
\begin{equation}\label{eqn:goldsteinCh12:620}
\sum_{k} \Bx_k \cross \left( \spacegrad_{\dot{\Bx}_k} \LL \right) = \text{constant}.
\end{equation}
%
but the ``traditional'' angular momentum \(\sum_k \Bx_k \cross m \dot{\Bx}_k\), is not.
}
%
