%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{classicalMechanicsPs2}
%\renewcommand{\dirname}{notes/phy354/problems/}
%%\newcommand{\keywords}{}
%
%\input{../peeter_prologue_print2.tex}
%
%%\usepackage{lipsum}
%
%\beginArtNoToc
%
%\generatetitle{PHY354 Advanced Classical Mechanics.  Problem set 2 (2012)}
\label{chap:classicalMechanicsPs2}
%
%\section{Disclaimer}
%
%Ungraded solutions to two of five of the problems from problem set 2 (I audited half the lectures for this course and intend to do the course problem sets if time allows after the fact.)
%
\makeproblem{Symmetries and conservation laws in external E.M. fields.}{classicalMechanicsPs2:problem:1}
{
{2012 PHY354 Problem set 2, problem 1}
%
Let us continue studying the Lagrangian of Problem 1 of Homework 1, namely, its symmetries, and the relevant conserved quantities. To this end, we will consider various cases of external scalar and vector potentials.
%
\makesubproblem{Consider first the case of time-independent \(\BA\) and \(\phi\). Find the expression for the conserved energy, \(\calE\), of the particle.}{classicalMechanicsPs2:problem:1:1}
\makesubproblem{For external \(\BA\) and \(\phi\) dependent on time, find \(d \calE/dt\).}{classicalMechanicsPs2:problem:1:2}
\makesubproblem{Let now \(\BA\) and \(\phi\) be spatially homogeneous, i.e. \(\Bx\)-independent. Find the conserved momentum. Is it equal to the usual \(m \Bv\)?}{classicalMechanicsPs2:problem:1:3}
\makesubproblem{Consider motion in the field of an electrostatic source (creating an external static \(\phi(\Bx)\)). Find the angular momentum of the particle. Is it conserved for all \(\phi(\Bx)\)?}{classicalMechanicsPs2:problem:1:4}
} % makeproblem
%
\makeanswer{classicalMechanicsPs2:problem:1}{
\makesubanswer{Conserved energy.}{classicalMechanicsPs2:problem:1:1}
%
Recall the argument for energy conservation, the result of considering time dependence of the Lagrangian.  We have
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:370}
\ddt{} \LL(q_i, \qdot_i, t)
=
\PD{q_i}{\LL} \PD{t}{q_i}
+\PD{\qdot_i}{\LL} \PD{t}{\qdot_i}
\PD{t}{\LL}
=
\left( \ddt{} \PD{\qdot_i}{\LL} \right) \PD{t}{q_i}
+ \PD{\qdot_i}{\LL} \PD{t}{\qdot_i}
+\PD{t}{\LL}
=
\ddt{} \left( \PD{\qdot_i}{\LL} \PD{t}{q_i} \right)
+ \PD{t}{\LL}.
\end{dmath}
%
Rearranging we have the conservation equation
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:390}
\ddt{} \left( \PD{\qdot_i}{\LL} \qdot_i -\LL \right) + \PD{t}{\LL} = 0.
\end{dmath}
%
We define the energy as
%
\boxedEquation{eqn:classicalMechanicsPs2:410}{
\calE = \PD{\qdot_i}{\LL} \qdot_i -\LL,
}
%
so that the when the Lagrangian is independent of time \(\calE\) is conserved, and in general
%
\begin{equation}\label{eqn:classicalMechanicsPs2:430}
\ddt{\calE} = - \PD{t}{\LL}.
\end{equation}
%
Application to this problem where our Lagrangian is
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:450}
\LL = \inv{2} m \Bv^2 + q \Bv \cdot \BA - q \phi,
\end{dmath}
%
we have
\begin{dmath}\label{eqn:classicalMechanicsPs2:470}
\PD{\Bv}{\LL} = m \Bv + q \BA.
\end{dmath}
%
so the energy is
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:490}
\calE =
\left( m \Bv + \cancel{q \BA} \right) \cdot \Bv -
\left( \inv{2} m \Bv^2 + \cancel{q \Bv \cdot \BA} - q \phi \right)
=
\inv{2} m \Bv^2 + q \phi,
\end{dmath}
%
with an end result of
\boxedEquation{eqn:classicalMechanicsPs2:491}{
\calE =
\inv{2} m \Bv^2 + q \phi.
}
%
\makesubanswer{Find \(d\calE/dt\).}{classicalMechanicsPs2:problem:1:2}
%
\paragraph{With direct computation.}
There are two ways we can try this.  One is with direct computation of the derivative from \eqnref{eqn:classicalMechanicsPs2:490}
%
\begin{dmath*}
\ddt{\calE}
=
\Bv \cdot (m \Ba) + q \ddt{\phi}
=
\Bv \cdot \left( q \BE + q \Bv \cross \BB \right) + q \left( \PD{t}{\phi} + \Bv \cdot \spacegrad \phi \right)
=
q \Bv \cdot (\BE + \spacegrad \phi) + q \cancel{\Bv \cdot \left(\Bv \cross \BB \right)} + q \PD{t}{\phi}
=
q \Bv \cdot \left(-\cancel{\spacegrad \phi} - \PD{t}{\BA} + \cancel{\spacegrad \phi} \right) + q \PD{t}{\phi}.
\end{dmath*}
%
So our end result is
%
\boxedEquation{eqn:classicalMechanicsPs2:510}{
\ddt{\calE}
=
-q \Bv \cdot \PD{t}{\BA} + q \PD{t}{\phi}.
}
%
\paragraph{Using the Lagrangian time partial.}
%
Doing it explicitly as above is the hard way.  We can do it from the conservation identity \eqnref{eqn:classicalMechanicsPs2:430} instead
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:590}
\ddt{\calE}
= -\PD{t}{\LL}
=
-\PD{t}{} \left(
\inv{2} m \Bv^2 + q \Bv \cdot \BA - q \phi
\right)
=
-q \Bv \cdot \PD{t}{\BA} + q \PD{t}{\phi},
\end{dmath}
%
as before.
%
\paragraph{Aside: Why not the ``expected'' \(q \Bv \cdot \BE\) result?}
%
From the relativistic treatment I expected
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:530}
\ddt{\calE} \questionEquals q \Bv \cdot \BE,
\end{dmath}
%
but that's not what we got.  With \(\calE = m \Bv^2/2 + q \phi\), it appears that we get a similar result considering just the Kinetic portion of the energy
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:550}
\inv{2} m \Bv^2 = \calE - q \phi.
\end{dmath}
%
Computing the derivative from above we have
%
\begin{dmath*}
\ddt{}\left(
\inv{2} m \Bv^2 \right)
=
-q \Bv \cdot \PD{t}{\BA} + q \PD{t}{\phi}
- q \ddt{\phi}
=
-q \Bv \cdot \PD{t}{\BA} + \cancel{q \PD{t}{\phi}}
- \cancel{q \PD{t}{\phi}} - q \Bv \cdot \spacegrad \phi
=
q \Bv \cdot \left(
-\spacegrad \phi
-\PD{t}{\BA} \right),
\end{dmath*}
%
or
\begin{dmath}\label{eqn:classicalMechanicsPs2:570}
\ddt{} \left(
\inv{2} m \Bv^2 \right) = \ddt{} \left( \calE - q \phi \right) = q \Bv \cdot \BE.
\end{dmath}
%
Looking back to what we did in the relativistic treatment, I see that my confusion was due to the fact that we actually computed
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:530b}
\ddt{\calE_{\mathrm{kin}}} = q \Bv \cdot \BE,
\end{dmath}
%
where \(\calE_{\mathrm{kin}} = \gamma m c^2\).  To first order, removing an additive constant, we have \(\gamma m c^2 \approx m \Bv^2/2\), so everything checks out.
%
\makesubanswer{Conserved momentum.}{classicalMechanicsPs2:problem:1:3}
%
The conserved momentum followed from a Noether's argument where we compute
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:610}
\frac{d\LL'}{d\epsilon}
=
\PD{q_i}{\LL'} \PD{\epsilon}{q_i}
+\PD{\qdot_i'}{\LL'} \PD{\epsilon}{\qdot_i'}
=
\left( \ddt{} \PD{\qdot_i}{\LL'} \right) \PD{\epsilon}{q_i}
+\PD{\qdot_i'}{\LL'} \PD{\epsilon}{\qdot_i'}
=
\ddt{} \left( \PD{\qdot_i'}{\LL'} \PD{\epsilon}{q_i'} \right),
\end{dmath}
%
where it has been assumed that a perturbed Lagrangian
\begin{equation}\label{eqn:classicalMechanicsPs2:610a}
\LL'(\epsilon) = \LL(q_i'(\epsilon), \qdot_i'(\epsilon), t),
\end{equation}
also satisfies the Euler Lagrange equations using the transformed coordinates.
With the coordinates transformed by a shift along some constant direction \(\Ba\) as in
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:630}
\Bx' = \Bx + \epsilon \Ba,
\end{dmath}
%
we have \(\PDi{\epsilon}{\Bx'} = \Ba\), so \eqnref{eqn:classicalMechanicsPs2:610} takes the form
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:650}
\frac{d\LL'}{d\epsilon} = \ddt{} \left( \PD{\xdot_i}{\LL'} a_i \right).
\end{dmath}
%
Our shifted Lagrangian for spatially homogeneous potentials \(\phi' = \phi\) and \(\BA' = \BA\) is
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:670}
\LL' = \inv{2} m {\Bv'}^2 + q \Bv' \cdot \BA - q \phi = \LL,
\end{dmath}
%
but \(\Bv' = \Bv\), so we've just got our canonical momentum \(\BM = \PDi{\xdot_i}{\LL}\) within the time derivative, and must have for all \(\Ba\)
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:690}
\ddt{ \BM } \cdot \Ba = 0.
\end{dmath}
%
The conserved momentum is then just
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:710}
\BM = m \Bv + q \BA.
\end{dmath}
%
\makesubanswer{Conserved angular momentum.}{classicalMechanicsPs2:problem:1:4}
%
Does the conserved angular momentum take the same from as \(\Bx \cross \BM\) as we had in a non-velocity dependent Lagrangian?  We can check using the same Noether arguments using the following coordinate transformation
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:730}
\Bx' = e^{-\epsilon j/2} \Bx e^{\epsilon j/2},
\end{dmath}
%
where \(j = \ucap \wedge \vcap\) is the geometric product of two perpendicular unit vectors, and \(\epsilon\) is the magnitude of the rotation.  This gives us
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:750}
\frac{d\Bx'}{d\epsilon} =
-\frac{j}{2} e^{-\epsilon j/2} \Bx e^{\epsilon j/2}
+ e^{-\epsilon j/2} \Bx e^{\epsilon j/2} \frac{j}{2}
=
\inv{2} \left( \Bx' j - j \Bx' \right)
= \Bx' \cdot j.
\end{dmath}
%
The Noether conservation statement is then
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:770}
\frac{d\LL'}{d\epsilon} = \ddt{} \left( \PD{\xdot_i}{\LL'} \Be_i \cdot (\Bx' \cdot j) \right).
\end{dmath}
%
With a static scalar potential \(\phi(\Bx)\) is our Lagrangian rotation invariant?  We have
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:790}
\LL'
=
\inv{2} {\Bv'}^2 - q \phi(\Bx')
=
\inv{2} {\Bv}^2 - q \phi(\Bx').
\end{dmath}
%
With zero vector potential, our kinetic term is invariant since the squared velocity is invariant, but we require \(\phi(\Bx') = \phi(\Bx)\) for total Lagrangian invariance.  We have that if \(\phi(\Bx) = \phi(\Abs{\Bx})\).
%
Evaluating the conservation identity \eqnref{eqn:classicalMechanicsPs2:770} at \(\epsilon = 0\) we have
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:810}
0
= \ddt{} \left( \BM \cdot (\Bx \cdot j) \right).
\end{dmath}
%
We are used to seeing this in dual form using the cross product
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:830}
\BM \cdot (\Bx \cdot j)
=
\gpgradezero{
\BM (\Bx \cdot j)
}
=
\inv{2} \gpgradezero{
\BM \Bx j - \BM j \Bx
}
=
\inv{2} \gpgradezero{
\BM \Bx j - \Bx \BM j
}
=
\inv{2} \gpgradezero{
\BM \wedge \Bx - \Bx \wedge \BM
}
\cdot j
=
\inv{2} \gpgradezero{
\left( \BM \wedge \Bx - \Bx \wedge \BM \right) \cdot j
}
=
(\BM \wedge \Bx) \cdot j
=
I (\BM \cross \Bx) \cdot j.
\end{dmath}
%
We are left with
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:910}
0 = I \frac{d}{dt} (\Bx \cross \BM) \cdot j,
\end{dmath}
%
but since \(j\) can be arbitrarily oriented, we have a requirement that
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:930}
0 = \frac{d}{dt} (\Bx \cross \BM).
\end{dmath}
%
This verifies that the our angular momentum is conserved, provided that \(\phi(\Bx) = \phi(\Abs{\Bx})\), and \(\BA = 0\).  With \(\BA = 0\), so that \(\BM = m \Bv + q \BA = m \Bv\) this is just
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:870}
\Bx \cross \BM = m \Bx \cross \Bv.
\end{dmath}
%
Note that the dependency on geometric algebra in the Noether's argument above can probably be eliminated by utilizing a rotational transformation of the form
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:871}
\Bx' = \Bx + \ncap \cross \Bx.
\end{dmath}
%
I'd guess (or perhaps recall if I attended that class), that this was the approach used.
%
%\paragraph{Computing the conserved quantity without use of Geometric Algebra.}
%
%Consider the expansion of our infinisimal rotation, projecting our vector \(\Bx\) into components lying in the plane of rotation \((\Bx \cdot j) j\) and perpendicular to that plane.  We have
%
%\begin{dmath}\label{eqn:classicalMechanicsPs2:890}
%\Bx'
%= e^{-j \epsilon/2} \Bx e^{j \epsilon/2}
%= e^{-j \epsilon/2} ((\Bx \cdot j) j + (\Bx \wedge j) j) e^{j \epsilon/2}
%= e^{-j \epsilon/2} ((\Bx \cdot j) e^{j \epsilon/2} j
%= ((\Bx \cdot j) e^{j \epsilon} j
%\approx ((\Bx \cdot j) j \epsilon
%=
%\inv{2} (\Bx j - j \Bx) j \epsilon
%=
%-I^2 \inv{2} (\Bx j - j \Bx) j \epsilon
%=
%\inv{2} (\Bx (-Ij) - (-Ij) \Bx) (I j) \epsilon
%=
%( \Bx \wedge (-Ij) ) j \epsilon.
%\end{dmath}
%
%FIXME: messed up.  try on paper first.  One of the mistakes is that j^2 = -1, I've got +1 above.
}
%
%\makeoproblem{Integrals of motion in a helix potential}{classicalMechanicsPs2:problem:2}
%{2012 PHY354 Problem set 2, problem 2}
%{
%Consider a particle moving in the external potential field (it could be gravitational or Coulomb, it is inessential
%for this problem) of an infinite homogeneous cylindrical helix. Find the conserved (linear combination of)
%components of \(\BP\) and \(\BM\).
%} % makeoproblem
%
%\makeanswer{classicalMechanicsPs2:problem:2}{
%TODO.
%
%Google shows that this is a problem found in \citep{landau1960classical}.  The argument there doesn't even rely on knowing what the form of the Lagrangian is (something I tried to calculate, and had trouble doing so).  %It would be nice to read that chapter of the text before attempting that problem, but that's not one that I have. ... ordered.
%% http://books.google.ca/books?id=e-xASAehg1sC&pg=PA21&lpg=PA21&dq=potential+for+an+infinite+cylindrical+helix&source=bl&ots=XPLMLrSh_s&sig=07oTC2n9GB_0svsV1cUXbbvoAZc&hl=en&sa=X&ei=1IfwT9SXMqmR6gGX1e3RBg&ved=0CEEQ6AEwAA#v=onepage&q=potential%20for%20an%20infinite%20cylindrical%20helix&f=false
%
%}
%
%\makeoproblem{``Hidden'' symmetries and integrals of motion}{classicalMechanicsPs2:problem:3}
%{2012 PHY354 Problem set 2, problem 3}
%{
%Consider the equation of motion of a particle of charge q moving in the field of a magnetic monopole:
%
%\begin{dmath}\label{eqn:classicalMechanicsPs2:330}
%\BB = g \frac{\Br}{r^3}, \BE = 0.
%\end{dmath}
%
%Here \(g\) is the magnetic charge, which can be found using the magnetic analogue of Gausses law: \(4 \pi Q_{\mathrm{magn}} = \int_{S^2} d\BSigma \cdot \BB = 4 \pi g\).  In this problem, do not start with a Lagrangian
%,but simply use the Lorentz force
%equation. Since we no longer deal with central forces, the angular momentum is no longer conserved, and
%the motion is no longer necessarily planar. However, it can be thought that a certain amount of angular
%momentum resides in the magnetic field, and, as first observed by Poincar\'e the total angular momentumm
%
%\begin{dmath}\label{eqn:classicalMechanicsPs2:350}
%\BD = \BM + c\frac{\Br}{r}.
%\end{dmath}
%
%is conserved (here \(\BM\) is the mechanical angular momentum \(\Br \cross \Bv\), and \(c\) is a constant).
%
%\makesubproblem{Find the value of \(c\) ensuring that \(d \BD/dt = 0\) for solutions of the equations of motion.}{classicalMechanicsPs2:problem:3:1}
%\makesubproblem{Show that the radius vector of the trajectory for a particle moving in the field of a monopole obeys \(\dot{\rcap} \cdot \BD = c\), where \(\dot{\rcap} = \Br/r\).}{classicalMechanicsPs2:problem:3:2}
%\makesubproblem{For a given value of \(\BD\), determined by the initial conditions, the relation found above restricts the
%motion of the particle on a particular surface in space. Draw this surface. What happens to this
%surface when \(g \rightarrow 0\)? Is it surprising?}{classicalMechanicsPs2:problem:3:3}
%\makesubproblem{Is energy conserved? Find the energy of the particle \(\calE\) as a function of \(\Bv\), \(\Br\), ... as appropriate to the case in hand.}{classicalMechanicsPs2:problem:3:4}
%
%Note that it is a fun and challenging problem to find \(\BA\) for the magnetic monopole, but it does not belong in this class.  Besides being a fun problem, the moral here is that finding symmetries and the related integrals of motion is not always so obvious. Usually, when integrals of motion exist, they are due to a symmetry. In this example, there is a ``hidden'' symmetry responsible for the conservation of \(\BD\).
%} % makeoproblem
%
%\makeanswer{classicalMechanicsPs2:problem:3}{
%\makesubanswer{Value of \(c\)}{classicalMechanicsPs2:problem:3:1}
%TODO.
%\makesubanswer{Trajectory radius vector}{classicalMechanicsPs2:problem:3:2}
%TODO.
%\makesubanswer{Trajectory surface}{classicalMechanicsPs2:problem:3:3}
%TODO.
%\makesubanswer{Is energy conserved}{classicalMechanicsPs2:problem:3:4}
%TODO.
%}
%
%\makeoproblem{Symmetries and conservation laws}{classicalMechanicsPs2:problem:4}
%{2012 PHY354 Problem set 2, problem 4}
%{
%What components of the momentum and angular momentum are conserved when a particle moves in the
%(say, gravitational) field of the following objects:
%
%\makesubproblem{An infinite homogeneous plane}{classicalMechanicsPs2:problem:4:1}
%\makesubproblem{An infinite homogeneous cylinder}{classicalMechanicsPs2:problem:4:2}
%\makesubproblem{Two point particles}{classicalMechanicsPs2:problem:4:3}
%\makesubproblem{An infinite homogeneous prism}{classicalMechanicsPs2:problem:4:4}
%\makesubproblem{A homogeneous cone}{classicalMechanicsPs2:problem:4:5}
%\makesubproblem{Three point particles}{classicalMechanicsPs2:problem:4:6}
%\makesubproblem{A homogeneous torus}{classicalMechanicsPs2:problem:4:7}
%
%This is a problem from last year's midterm. Problems 2. and 4. are rather similar in nature. Be sure to ``internalize'' them -- they will come handy during exams but also in your life as physicists.
%} % makeoproblem
%
%\makeanswer{classicalMechanicsPs2:problem:4}{
%\makesubanswer{An infinite homogeneous plane}{classicalMechanicsPs2:problem:4:1}
%TODO.
%\makesubanswer{An infinite homogeneous cylinder}{classicalMechanicsPs2:problem:4:2}
%TODO.
%\makesubanswer{Two point particles}{classicalMechanicsPs2:problem:4:3}
%TODO.
%\makesubanswer{An infinite homogeneous prism}{classicalMechanicsPs2:problem:4:4}
%TODO.
%\makesubanswer{A homogeneous cone}{classicalMechanicsPs2:problem:4:5}
%TODO.
%\makesubanswer{Three point particles}{classicalMechanicsPs2:problem:4:6}
%TODO.
%\makesubanswer{A homogeneous torus}{classicalMechanicsPs2:problem:4:7}
%TODO.
%}
%
\makeproblem{Angular momentum in spherical and cylindrical coordinates.}{classicalMechanicsPs2:problem:5}
{
{2012 PHY354 Problem set 2, problem 5}
\makesubproblem{Find \(M_x, M_y, M_z, \BM^2\) in spherical coordinates \((r, \theta, \phi)\).}{classicalMechanicsPs2:problem:5:1}
\makesubproblem{Find \(M_x, M_y, M_z, \BM^2\) in cylindrical coordinates \((r, \phi, z)\).}{classicalMechanicsPs2:problem:5:2}
%
%Everybody should do this once in their lives (and should be able to do at any point thereafter).
%My SQL-guru, but non-physisist girlfriend, was amused by the additional comment in the statement of the problem ``\textunderline{Everybody} should do this once in their lives (and should be able to do at any point thereafter).
} % makeproblem
%
\makeanswer{classicalMechanicsPs2:problem:5}{
%
\makesubanswer{Spherical coordinates.}{classicalMechanicsPs2:problem:5:1}
%
In Cartesian coordinates our angular momentum is
%
\begin{equation}\label{eqn:classicalMechanicsPs2:950}
\begin{aligned}
\BM
&= \Br \cross (m \Bv) \\
&=
m (y v_z - z v_y) \xcap
+m (z v_x - x v_z) \ycap
+m (x v_y - y v_x) \zcap.
\end{aligned}
\end{equation}
%
Substituting \(x,y,z\) is easy since we have
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:10}
\begin{bmatrix}
x \\
y \\
z
\end{bmatrix}
=
r
\begin{bmatrix}
\sin\theta \cos\phi \\
\sin\theta \sin\phi \\
\cos\theta
\end{bmatrix},
\end{dmath}
%
but the \(\Bv\) substitution requires more work.  We have
%
\begin{equation}\label{eqn:classicalMechanicsPs2:970}
\begin{aligned}
\Bv
&= \frac{d \Br}{dt} \\
&= \frac{d}{dt} (r \rcap) \\
&= \rdot \rcap + r \ddt{\rcap}.
\end{aligned}
\end{equation}
%
\begin{equation}\label{eqn:classicalMechanicsPs2:990}
\begin{aligned}
\ddt{\rcap}
&=
\ddt{}
\begin{bmatrix}
\sin\theta \cos\phi \\
\sin\theta \sin\phi \\
\cos\theta
\end{bmatrix} \\
&=
\begin{bmatrix}
\cos\theta \cos\phi \thetadot - \sin\theta \sin\phi \phidot \\
\cos\theta \sin\phi \thetadot + \sin\theta \cos\phi \phidot \\
-\sin\theta \thetadot
\end{bmatrix}.
\end{aligned}
\end{equation}
%
So we have
%
\begin{subequations}
\label{eqn:classicalMechanicsPs2:30a}
\begin{dmath}\label{eqn:classicalMechanicsPs2:30}
\Bv =
\begin{bmatrix}
\rdot \sin\theta \cos\phi + r \cos\theta \cos\phi \thetadot - r \sin\theta \sin\phi \phidot \\
\rdot \sin\theta \sin\phi + r \cos\theta \sin\phi \thetadot + r \sin\theta \cos\phi \phidot \\
\rdot \cos\theta -r \sin\theta \thetadot
\end{bmatrix},
\end{dmath}
%
\begin{equation}\label{eqn:classicalMechanicsPs2:1010}
\frac{\BM}{mr} =
%m r
\begin{bmatrix}
\sin\theta \sin\phi v_z - \cos\theta v_y \\
\cos\theta v_x - \sin\theta \cos\phi v_z \\
\sin\theta \cos\phi v_y - \sin\theta \sin\phi v_x
\end{bmatrix}.
\end{equation}
\end{subequations}
Expanding this is a bit of a mess, but it eventually simplifies.  We start with
\begin{equation}\label{eqn:classicalMechanicsPs2:1010a}
\begin{bmatrix}
S_\theta S_\phi (\rdot C_\theta -r S_\theta \thetadot) - C_\theta (\rdot S_\theta S_\phi + r C_\theta S_\phi \thetadot + r S_\theta C_\phi \phidot) \\
C_\theta (\rdot S_\theta C_\phi + r C_\theta C_\phi \thetadot - r S_\theta S_\phi \phidot) - S_\theta C_\phi (\rdot C_\theta -r S_\theta \thetadot) \\
S_\theta C_\phi (\rdot S_\theta S_\phi + r C_\theta S_\phi \thetadot + r S_\theta C_\phi \phidot) - S_\theta S_\phi (\rdot S_\theta C_\phi + r C_\theta C_\phi \thetadot - r S_\theta S_\phi \phidot)
\end{bmatrix},
\end{equation}
then
\begin{equation}\label{eqn:classicalMechanicsPs2:1010b}
\begin{bsmallmatrix}
\cancel{\rdot C_\theta S_\theta S_\phi }
- r \thetadot S_\theta^2 S_\phi
- \cancel{\rdot S_\theta C_\theta S_\phi }
- r \thetadot C_\theta^2 S_\phi
- r \phidot S_\theta C_\theta C_\phi
\\
\cancel{\rdot S_\theta C_\theta C_\phi }
+ r \thetadot C_\theta^2 C_\phi
- r \phidot S_\theta C_\theta S_\phi
-\cancel{\rdot C_\theta S_\theta C_\phi }
+r \thetadot S_\theta^2 C_\phi
\\
\cancel{\rdot S_\theta^2 S_\phi C_\phi }
+ \cancel{r \thetadot C_\theta S_\theta C_\phi S_\phi }
+ r \phidot S_\theta^2 C_\phi^2
- \cancel{\rdot S_\theta^2 S_\phi C_\phi }
- \cancel{r \thetadot C_\theta S_\theta S_\phi C_\phi }
+ r \phidot S_\theta^2 S_\phi^2
\end{bsmallmatrix},
\end{equation}
and finally
\begin{equation}\label{eqn:classicalMechanicsPs2:1010c}
\begin{bmatrix}
- r \thetadot S_\phi
- r \phidot S_\theta C_\theta C_\phi
\\
+ r \thetadot C_\phi
- r \phidot S_\theta C_\theta S_\phi
\\
+ r \phidot S_\theta^2
\end{bmatrix}.
\end{equation}
%
In matrix form, we have (and can read off \(M_x, M_y, M_z\))
%
\boxedEquation{eqn:classicalMechanicsPs2:50}{
\BM =
\inv{2} m r^2
\begin{bmatrix}
-  2 \sin\phi & - \sin(2\theta) \cos\phi \\
  2 \cos\phi & - \sin(2\theta) \sin\phi \\
0 & 1 - \cos(2\theta)
\end{bmatrix}
\begin{bmatrix}
\thetadot \\
\phidot
\end{bmatrix}.
}
%
We have also been asked to find \(\BM^2\) and can write this as a quadratic form
%
\begin{equation}\label{eqn:classicalMechanicsPs2:1030}
\begin{aligned}
\BM^2
&=
\inv{4} m^2 r^4
\begin{bmatrix}
\thetadot & \phidot
\end{bmatrix}
\begin{bmatrix}
-  2 \sin\phi  & 2 \cos\phi  & 0 \\
- \sin(2\theta) \cos\phi & - \sin(2\theta) \sin\phi  & 1 - \cos(2\theta)
\end{bmatrix} \times \\
&\quad
\begin{bmatrix}
-  2 \sin\phi & - \sin(2\theta) \cos\phi \\
  2 \cos\phi & - \sin(2\theta) \sin\phi \\
0 & 1 - \cos(2\theta)
\end{bmatrix}
\begin{bmatrix}
\thetadot \\
\phidot
\end{bmatrix}  \\
&=
\inv{4} m^2 r^4
\begin{bmatrix}
\thetadot & \phidot
\end{bmatrix}
\begin{bmatrix}
4 & 0 \\
0 & 2(1 - \cos(2\theta))
\end{bmatrix}
\begin{bmatrix}
\thetadot \\
\phidot
\end{bmatrix}.
\end{aligned}
\end{equation}
%
This simplifies surprisingly, leaving only
%
\boxedEquation{eqn:classicalMechanicsPs2:70}{
\BM^2
=
m^2 r^4 \lr{  \thetadot^2 + \sin^2\theta \phidot^2  }.
}
%
\makesubanswer{Spherical coordinates - a smarter way.}{classicalMechanicsPs2:problem:5:1}
%
Observe that we have no \(\rdot\) factors in the angular momentum.  This makes sense when we consider that the total angular momentum is
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:190}
\BM = m r \rcap \cross \Bv,
\end{dmath}
%
so the \(\rdot \rcap\) term of the velocity is necessarily killed.  Let us do that simplification first.  We want our velocity completely specified in a \(\{\rcap, \thetacap, \phicap\}\) basis, and note that our basis vectors are
%
\begin{equation}\label{eqn:classicalMechanicsPs2:210}
\begin{aligned}
\rcap &=
\begin{bmatrix}
\sin\theta \cos\phi \\
\sin\theta \sin\phi \\
\cos\theta
\end{bmatrix} \\
\thetacap &=
\begin{bmatrix}
\cos\theta \cos\phi \\
\cos\theta \sin\phi \\
-\sin\theta
\end{bmatrix} \\
\phicap &=
\begin{bmatrix}
-\sin\phi \\
\cos\phi \\
0
\end{bmatrix} .
\end{aligned}
\end{equation}
%
We wish to rewrite
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:230}
\ddt{\rcap} =
\begin{bmatrix}
\cos\theta \cos\phi & - \sin\theta \sin\phi \\
\cos\theta \sin\phi & \sin\theta \cos\phi \\
-\sin\theta & 0
\end{bmatrix}
\begin{bmatrix}
\thetadot \\
\phidot
\end{bmatrix},
\end{dmath}
%
in terms of these spherical unit vectors and find
%
\begin{equation}\label{eqn:classicalMechanicsPs2:250}
\begin{aligned}
\frac{d\rcap}{dt} \cdot \rcap &= \rcap^\T \ddt{\rcap} = 0  \\
\frac{d\rcap}{dt} \cdot \thetacap &= \thetacap^\T \ddt{\rcap} = \thetadot \\
\frac{d\rcap}{dt} \cdot \phicap &= \phicap^\T \ddt{\rcap} = \phidot \sin\theta.
\end{aligned}
\end{equation}
%
So our velocity is
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:270}
\Bv = \rdot \rcap + r
\lr{ \thetadot \thetacap + \phidot \sin\theta \phicap }.
\end{dmath}
%
As an aside, now that we know the Euler-Lagrange methods, we could also compute this velocity from the spherical free particle Lagrangian by writing out the canonical momentum in vector form.  We have
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:290}
\LL = \inv{2} m
\lr{  \rdot^2 + r^2 \thetadot^2 + r^2 \phidot^2 \sin^2 \theta }.
\end{dmath}
%
We expect our canonical momentum in vector form to be
%
\begin{equation}\label{eqn:classicalMechanicsPs2:1050}
\begin{aligned}
\BP &=
\PD{\rdot}{\LL} \rcap
+\PD{\thetadot}{\LL} \frac{\thetacap}{r}
+\PD{\phidot}{\LL} \frac{\phicap}{r \sin\theta} \\
&=
m \rdot \rcap
+ m r^2 \thetadot \frac{\thetacap}{r}
+ m r^2 \sin^2\theta \phidot \frac{\phicap}{r \sin\theta} \\
&=
m
\left(
\rdot \rcap + r \thetadot \thetacap + r \sin\theta \phidot \phicap
\right) \\
&= m \Bv.
\end{aligned}
\end{equation}
%
This is consistent with \eqnref{eqn:classicalMechanicsPs2:270} calculated hard way, and is a nice verification that the canonical momentum matches the expectation of being nothing more than how to express the momentum in different coordinate systems.  Returning to the angular momentum calculation we have
%
\begin{equation}\label{eqn:classicalMechanicsPs2:1070}
\begin{aligned}
\rcap \cross \Bv
&=
r \rcap \cross \lr{ \thetadot \thetacap + \phidot \sin\theta \phicap } \\
&=
r \left( \thetadot \phicap - \phidot \sin\theta \thetacap \right).
\end{aligned}
\end{equation}
%
Our total angular momentum in vector form is
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:310}
\BM = m r^2
\left( \thetadot \phicap - \phidot \sin\theta \thetacap \right).
\end{dmath}
%
Now, should we wish to extract coordinates with respect to \(x,y,z\) we just have to write our vectors \(\phicap\) and \(\thetacap\) in the \(\{\Be_1, \Be_2, \Be_3\}\) basis and have
%
\begin{equation}\label{eqn:classicalMechanicsPs2:1090}
\begin{aligned}
\BM
&=
m r^2
\begin{bmatrix}
\phicap & -\sin\theta \thetacap
\end{bmatrix}
\begin{bmatrix}
\thetadot \\
\phidot
\end{bmatrix} \\
&=
m r^2
\begin{bmatrix}
-\sin\phi & -\sin\theta(\cos\theta \cos\phi) \\
\cos\phi & -\sin\theta(\cos\theta \sin\phi) \\
0 & \sin^2\theta
\end{bmatrix}
\begin{bmatrix}
\thetadot \\
\phidot
\end{bmatrix} .
\end{aligned}
\end{equation}
%
This matches \eqnref{eqn:classicalMechanicsPs2:50}, but all the messy trig is isolated to the calculation of \(\Bv\) in the spherical polar basis.
%
\makesubanswer{Cylindrical coordinates.}{classicalMechanicsPs2:problem:5:2}
%
This one should be easier.  To start our position vector is
%
\begin{equation}\label{eqn:classicalMechanicsPs2:90}
\Br =
\begin{bmatrix}
\rho \cos\phi \\
\rho \sin\phi \\
z
\end{bmatrix}
= \rho \rhocap + z \zcap.
\end{equation}
%
Our velocity is
%
\begin{equation}\label{eqn:classicalMechanicsPs2:1110}
\begin{aligned}
\Bv
&= \rhodot \rhocap + \rho \ddt{\rhocap} + \zdot \zcap \\
&= \rhodot \rhocap + \rho \ddt{}
\lr{ \Be_1 e^{i\phi} }
 + \zdot \zcap \\
&= \rhodot \rhocap + \rho \phidot \Be_2 e^{i\phi} + \zdot \zcap \\
&= \rhodot \rhocap + \rho \phidot \phicap + \zdot \zcap .
\end{aligned}
\end{equation}
%
Here, I have used the Clifford algebra representation of \(\rhocap\) with the plane bivector \(i = \Be_1 \Be_2\).  In coordinates we have
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:110}
\phicap = \Be_2
\lr{ \cos\phi + \Be_1 \Be_2 \sin\phi }
 = -\Be_1 \sin\phi + \Be_2 \cos\phi,
\end{dmath}
%
so our velocity in matrix form is
\begin{dmath}\label{eqn:classicalMechanicsPs2:130}
\Bv = \rhodot
\begin{bmatrix}
\cos\phi \\
\sin\phi \\
0
\end{bmatrix}
+
\rho \phidot
\begin{bmatrix}
-\sin\phi \\
\cos\phi \\
0
\end{bmatrix}
+
\zdot
\begin{bmatrix}
0 \\
0 \\
1
\end{bmatrix}
=
\begin{bmatrix}
\rhodot \cos\phi - \rho \phidot \sin\phi \\
\rhodot \sin\phi + \rho \phidot \cos\phi \\
\zdot
\end{bmatrix}.
\end{dmath}
%
For our angular momentum we get
%
\begin{equation}\label{eqn:classicalMechanicsPs2:1130}
\begin{aligned}
\BM
&= \Br \cross (m \Bv) \\
&=
m
\begin{bmatrix}
\rho\sin\phi \zdot - z \lr{ \rhodot \sin\phi + \rho \phidot \cos\phi } \\
z \lr{ \rhodot \cos\phi - \rho \phidot \sin\phi } - \rho \cos\phi \zdot \\
\rho \cos\phi \lr{ \cancel{\rhodot \sin\phi} + \rho \phidot \cos\phi }
 - \rho\sin\phi \lr{ \cancel{\rhodot \cos\phi} - \rho \phidot \sin\phi }
\end{bmatrix} .
\end{aligned}
\end{equation}
%
We can now read off \(M_x, M_y, M_z\) by inspection
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:150}
\BM =
m
\begin{bmatrix}
(\rho \zdot
- z \rhodot )\sin\phi
- z \rho \phidot \cos\phi
\\
( z \rhodot
- \rho \zdot ) \cos\phi
- z \rho \phidot \sin\phi
\\
\rho^2 \phidot
\end{bmatrix}.
\end{dmath}
%
We also want the (squared) magnitude, which is
%
\begin{dmath}\label{eqn:classicalMechanicsPs2:170}
\BM^2
%=
%m^2 \left(
%(\rho \zdot - z \rhodot )^2
%+ (z \rho \phidot)^2
%+ \rho^4 \phidot^2
%\right)
=
m^2 \left(
(\rho \zdot - z \rhodot )^2
+ \rho^2 \phidot^2 ( z^2 + \rho^2 )
%+ (z \rho \phidot)^2
%+ \rho^4 \phidot^2
\right).
\end{dmath}
}
%
%\vcsinfo
%\EndArticle
%\EndNoBibArticle
